import{_ as e,a as r}from"./server.mjs";import{ssrRenderAttrs as l,ssrInterpolate as u,ssrRenderComponent as h,ssrRenderAttr as d,ssrRenderSuspense as f}from"vue/server-renderer";import{useSSRContext as F,inject as V,ref as W,reactive as q,defineComponent as $,toRefs as Q,shallowRef as J,watch as re,createElementBlock as oe,createCommentVNode as ae,onUnmounted as le,unref as ce,openBlock as ue,renderSlot as de,createElementVNode as ge,watchEffect as ve,useSlots as ye,useAttrs as be,computed as xe,isRef as Te,createVNode as Ae,render as Me,createBlock as Ee,getCurrentScope as Pe,onScopeDispose as Ie,withAsyncContext as Se,mergeProps as Ce,withCtx as Le,createTextVNode as De,Suspense as ke}from"vue";import*as Oe from"three";import{Clock as Ne,REVISION as Ue,MOUSE as je,TOUCH as ze,DefaultLoadingManager as Be,EventDispatcher as Fe,Vector3 as Ve,Spherical as Ye,Quaternion as We,OrthographicCamera as qe,Vector2 as Ze,PerspectiveCamera as $e,Ray as Qe,Plane as Je,Loader as et,FileLoader as tt,BufferGeometry as nt,BufferAttribute as rt,LoaderUtils as st,MeshPhysicalMaterial as it,Color as ot,SpotLight as at,PointLight as lt,DirectionalLight as ut,Matrix4 as ht,InstancedMesh as pt,InstancedBufferAttribute as dt,Object3D as ft,TextureLoader as mt,ImageBitmapLoader as gt,InterleavedBuffer as vt,InterleavedBufferAttribute as yt,LinearMipmapLinearFilter as bt,NearestMipmapLinearFilter as xt,LinearMipmapNearestFilter as wt,NearestMipmapNearestFilter as Tt,LinearFilter as _t,NearestFilter as At,RepeatWrapping as Mt,MirroredRepeatWrapping as Et,ClampToEdgeWrapping as Pt,Texture as Rt,PointsMaterial as It,Material as St,LineBasicMaterial as Ct,MeshStandardMaterial as Lt,DoubleSide as Dt,MeshBasicMaterial as kt,PropertyBinding as Ot,SkinnedMesh as Ut,Mesh as jt,LineSegments as zt,Line as Bt,LineLoop as Ft,Points as Ht,Group as Gt,MathUtils as Vt,Skeleton as Yt,AnimationClip as Xt,Bone as Kt,InterpolateDiscrete as Wt,InterpolateLinear as qt,VectorKeyframeTrack as Zt,NumberKeyframeTrack as $t,QuaternionKeyframeTrack as Qt,FrontSide as Jt,TrianglesDrawMode as tn,TriangleFanDrawMode as nn,TriangleStripDrawMode as rn,Interpolant as sn,Box3 as on,Sphere as an,AudioListener as ln,Audio as cn,AudioLoader as un,ShaderMaterial as hn,BackSide as pn,UniformsUtils as dn,Triangle as fn,Euler as mn,Vector4 as vn,Line3 as yn,PlaneGeometry as bn,BoxGeometry as xn,WebGLRenderTarget as Tn,HalfFloatType as _n,NoToneMapping as Mn,CompressedTexture as Pn,Scene as Rn,DataTexture as In,RGBAFormat as Sn,RawShaderMaterial as Cn,AdditiveBlending as Ln,Box2 as kn,Uniform as On,WebGLRenderer as Nn,ShapePath as Un}from"three";import{useRafFn as jn,createEventHook as zn}from"@vueuse/core";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"consola";import"node:url";import"vue-router";const Bn={};const Fn=Bn.setup;Bn.setup=(e,r)=>{const l=F();return(l.modules||(l.modules=new Set)).add("node_modules/@tresjs/nuxt/dist/runtime/TresCanvas.server.vue"),Fn?Fn(e,r):void 0};const Hn=e(Bn,[["ssrRender",function(e,r,u,h){r(`<span${l(h)}></span>`)}]]);async function Dn(e,r,l,u,h){const{logError:d}={logError:cr$1,logWarning:ur$1,logMessage:fr$1},f=new e;return l&&l(f),await new Promise((e,l)=>{f.load(r,r=>{const l=r;l.scene&&Object.assign(l,function(e){const r={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(r.nodes[e.name]=e),e.material&&!r.materials[e.material.name]&&(r.materials[e.material.name]=e.material)}),r}(l.scene)),e(l)},u,e=>{d("[useLoader] - Failed to load resource",e),l(e)})})}const Gn="[TresJS ▲ ■ ●] ";function cr$1(...e){"string"==typeof e[0]?e[0]=Gn+e[0]:e.unshift(Gn)}function ur$1(...e){"string"==typeof e[0]?e[0]=Gn+e[0]:e.unshift(Gn)}function fr$1(e,r){}function me(){const e=V("useTres");if(!e)throw new Error("useTresContext must be used together with useTresContextProvider");return e}function Zr$1(){const{camera:e,scene:r,renderer:l,loop:u,raycaster:h,controls:d,invalidate:f,advance:F}=me();return u.setContext({camera:e,scene:r,renderer:l,raycaster:h,controls:d,invalidate:f,advance:F}),{pause:u.pause,resume:u.resume,pauseRender:u.pauseRender,resumeRender:u.resumeRender,isActive:u.isActive,onBeforeRender:function(e,r=0){return u.register(e,"before",r)},render:function(e){return u.register(e,"render")},onAfterRender:function(e,r=0){return u.register(e,"after",r)}}}W({}),Number.parseInt(Ue.replace("dev",""));const Vn=zn(),Yn=zn(),Xn=zn(),Kn=new Ne;let Wn=0,qn=0;const{pause:$n,resume:Qn,isActive:Jn}=jn(()=>{Vn.trigger({delta:Wn,elapsed:qn,clock:Kn}),Yn.trigger({delta:Wn,elapsed:qn,clock:Kn}),Xn.trigger({delta:Wn,elapsed:qn,clock:Kn})},{immediate:!1});Xn.on(()=>{Wn=Kn.getDelta(),qn=Kn.getElapsedTime()});let nr=!1;q({sceneGraph:null});var sr=Object.defineProperty,pe=(e,r,l)=>((e,r,l)=>r in e?sr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l)(e,"symbol"!=typeof r?r+"":r,l);function ct(e){return"function"==typeof e?e():ce(e)}typeof WorkerGlobalScope<"u"&&(globalThis,WorkerGlobalScope);const ir=Object.prototype.toString,wn=()=>{};function gn(e){var r;const l=ct(e);return null!=(r=null==l?void 0:l.$el)?r:l}function Xe(...e){let r,l,u,h;if("string"==typeof e[0]||Array.isArray(e[0])?([l,u,h]=e,r=undefined):[r,l,u,h]=e,!r)return wn;Array.isArray(l)||(l=[l]),Array.isArray(u)||(u=[u]);const d=[],o=()=>{d.forEach(e=>e()),d.length=0},f=re(()=>[gn(r),ct(h)],([e,r])=>{if(o(),!e)return;const h=(e=>"[object Object]"===ir.call(e))(r)?{...r}:r;d.push(...l.flatMap(r=>u.map(l=>((e,r,l,u)=>(e.addEventListener(r,l,u),()=>e.removeEventListener(r,l,u)))(e,r,l,h))))},{immediate:!0,flush:"post"}),c=()=>{f(),o()};return function(e){!!Pe()&&Ie(e)}(c),c}function No(e,r,l,u){const h=class extends hn{constructor(u={}){const h=Object.entries(e);super({uniforms:h.reduce((e,[r,l])=>({...e,...dn.clone({[r]:{value:l}})}),{}),vertexShader:r,fragmentShader:l}),pe(this,"key",""),h.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:r=>this.uniforms[e].value=r})),Object.assign(this,u)}};return h.key=Vt.generateUUID(),h}$({name:"GlobalAudio",props:["src","loop","volume","playbackRate","playTrigger","stopTrigger"],async setup(e,{expose:r,emit:l}){var u;const{camera:h,renderer:d}=me(),f=new ln;null==(u=h.value)||u.add(f);const F=new cn(f),V=new un;r({instance:F}),le(()=>{F&&F.disconnect()}),re(()=>[e.playbackRate],()=>F.setPlaybackRate(e.playbackRate??1),{immediate:!0}),re(()=>[e.volume],()=>F.setVolume(e.volume??.5),{immediate:!0}),re(()=>[e.loop],()=>F.setLoop(e.loop??!1),{immediate:!0}),re(()=>[e.src],async()=>{const r=await V.loadAsync(e.src);F.setBuffer(r)},{immediate:!0});Xe((void 0).getElementById(e.playTrigger??"")||d.value.domElement,"click",()=>{F.isPlaying?F.pause():F.play(),l("isPlaying",F.isPlaying)});const W=(void 0).getElementById(e.stopTrigger??"");return W&&Xe(W,"click",()=>{F.stop(),l("isPlaying",F.isPlaying)}),null}}),No({color:new ot("white"),scale:new Ze(1,1),imageBounds:new Ze(1,1),resolution:1024,map:null,zoom:1,radius:0,grayscale:0,opacity:1},"\n    varying vec2 vUv;\n    varying vec2 vPos;\n    void main() {\n      gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4(position, 1.);\n      vUv = uv;\n      vPos = position.xy;\n    }\n  ","\n    // mostly from https://gist.github.com/statico/df64c5d167362ecf7b34fca0b1459a44\n    varying vec2 vUv;\n    varying vec2 vPos;\n    uniform vec2 scale;\n    uniform vec2 imageBounds;\n    uniform float resolution;\n    uniform vec3 color;\n    uniform sampler2D map;\n    uniform float radius;\n    uniform float zoom;\n    uniform float grayscale;\n    uniform float opacity;\n    const vec3 luma = vec3(.299, 0.587, 0.114);\n    vec4 toGrayscale(vec4 color, float intensity) {\n      return vec4(mix(color.rgb, vec3(dot(color.rgb, luma)), intensity), color.a);\n    }\n    vec2 aspect(vec2 size) {\n      return size / min(size.x, size.y);\n    }\n    \n    const float PI = 3.14159265;\n      \n    // from https://iquilezles.org/articles/distfunctions\n    float udRoundBox( vec2 p, vec2 b, float r ) {\n      return length(max(abs(p)-b+r,0.0))-r;\n    }\n  \n    void main() {\n      vec2 s = aspect(scale);\n      vec2 i = aspect(imageBounds);\n      float rs = s.x / s.y;\n      float ri = i.x / i.y;\n      vec2 new = rs < ri ? vec2(i.x * s.y / i.y, s.y) : vec2(s.x, i.y * s.x / i.x);\n      vec2 offset = (rs < ri ? vec2((new.x - s.x) / 2.0, 0.0) : vec2(0.0, (new.y - s.y) / 2.0)) / new;\n      vec2 uv = vUv * s / new + offset;\n      vec2 zUv = (uv - vec2(0.5, 0.5)) / zoom + vec2(0.5, 0.5);\n  \n      vec2 res = vec2(scale * resolution);\n      vec2 halfRes = 0.5 * res;\n      float b = udRoundBox(vUv.xy * res - halfRes, halfRes, resolution * radius);    \n        vec3 a = mix(vec3(1.0,0.0,0.0), vec3(0.0,0.0,0.0), smoothstep(0.0, 1.0, b));\n      gl_FragColor = toGrayscale(texture2D(map, zUv) * vec4(color, opacity * a), grayscale);\n      \n      #include <tonemapping_fragment>\n      #include <colorspace_fragment>\n    }\n  ");const or=parseInt(Ue.replace(/\D+/g,""));function er(e,r){if(r===tn)return e;if(r===nn||r===rn){let l=e.getIndex();if(null===l){const r=[],u=e.getAttribute("position");if(void 0===u)return e;for(let e=0;e<u.count;e++)r.push(e);e.setIndex(r),l=e.getIndex()}const u=l.count-2,h=[];if(l)if(r===nn)for(let e=1;e<=u;e++)h.push(l.getX(0)),h.push(l.getX(e)),h.push(l.getX(e+1));else for(let e=0;e<u;e++)e%2==0?(h.push(l.getX(e)),h.push(l.getX(e+1)),h.push(l.getX(e+2))):(h.push(l.getX(e+2)),h.push(l.getX(e+1)),h.push(l.getX(e)));h.length;const d=e.clone();return d.setIndex(h),d.clearGroups(),d}return e}var lr=Object.defineProperty;async function tr(e){const r=await e.arrayBuffer(),l=btoa(String.fromCharCode(...new Uint8Array(r)));return`data:${e.type||""};base64,${l}`}let cr,hr,pr,dr;function Ei(e,r=1/0,l=null){hr||(hr=new bn(2,2,1,1)),pr||(pr=new hn({uniforms:{blitTexture:new On(e)},vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = vec4(position.xy * 1.0,0.,.999999);\n        }\n      ",fragmentShader:"\n          uniform sampler2D blitTexture; \n          varying vec2 vUv;\n\n          void main(){ \n              gl_FragColor = vec4(vUv.xy, 0, 1);\n              \n              #ifdef IS_SRGB\n              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );\n              #else\n              gl_FragColor = texture2D( blitTexture, vUv);\n              #endif\n          }\n      "})),pr.uniforms.blitTexture.value=e,pr.defines.IS_SRGB="colorSpace"in e?"srgb"===e.colorSpace:3001===e.encoding,pr.needsUpdate=!0,dr||(dr=new jt(hr,pr),dr.frustrumCulled=!1);const u=new $e,h=new Rn;h.add(dr),l||(l=cr=new Nn({antialias:!1})),l.setSize(Math.min(e.image.width,r),Math.min(e.image.height,r)),l.clear(),l.render(h,u);const d=new Rt(l.domElement);return d.minFilter=e.minFilter,d.magFilter=e.magFilter,d.wrapS=e.wrapS,d.wrapT=e.wrapT,d.name=e.name,cr&&(cr.dispose(),cr=null),d}const fr={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Uo{constructor(){this.pluginCallbacks=[],this.register(function(e){return new Eu(e)}),this.register(function(e){return new Vr(e)}),this.register(function(e){return new Kr(e)}),this.register(function(e){return new Wr(e)}),this.register(function(e){return new qr(e)}),this.register(function(e){return new Zr(e)}),this.register(function(e){return new Yr(e)}),this.register(function(e){return new Xr(e)}),this.register(function(e){return new $r(e)}),this.register(function(e){return new Qr(e)}),this.register(function(e){return new Jr(e)})}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,r,l,u){const h=new bu,d=[];for(let e=0,r=this.pluginCallbacks.length;e<r;e++)d.push(this.pluginCallbacks[e](h));h.setPlugins(d),h.write(e,r,u).catch(l)}parseAsync(e,r){const l=this;return new Promise(function(u,h){l.parse(e,u,h,r)})}}var gr;gr={insertKeyframe:function(e,r){const l=e.getValueSize(),u=new e.TimeBufferType(e.times.length+1),h=new e.ValueBufferType(e.values.length+l),d=e.createInterpolant(new e.ValueBufferType(l));let f;if(0===e.times.length){u[0]=r;for(let e=0;e<l;e++)h[e]=0;f=0}else if(r<e.times[0]){if(Math.abs(e.times[0]-r)<.001)return 0;u[0]=r,u.set(e.times,1),h.set(d.evaluate(r),0),h.set(e.values,l),f=0}else if(r>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-r)<.001)return e.times.length-1;u[u.length-1]=r,u.set(e.times,0),h.set(e.values,0),h.set(d.evaluate(r),e.values.length),f=u.length-1}else for(let F=0;F<e.times.length;F++){if(Math.abs(e.times[F]-r)<.001)return F;if(e.times[F]<r&&e.times[F+1]>r){u.set(e.times.slice(0,F+1),0),u[F+1]=r,u.set(e.times.slice(F+1),F+2),h.set(e.values.slice(0,(F+1)*l),0),h.set(d.evaluate(r),(F+1)*l),h.set(e.values.slice((F+1)*l),(F+2)*l),f=F+1;break}}return e.times=u,e.values=h,f},mergeMorphTargetTracks:function(e,r){const l=[],u={},h=e.tracks;for(let e=0;e<h.length;++e){let d=h[e];const f=Ot.parseTrackName(d.name),F=Ot.findNode(r,f.nodeName);if("morphTargetInfluences"!==f.propertyName||void 0===f.propertyIndex){l.push(d);continue}if(d.createInterpolant!==d.InterpolantFactoryMethodDiscrete&&d.createInterpolant!==d.InterpolantFactoryMethodLinear){if(d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");d=d.clone(),d.setInterpolation(qt)}const V=F.morphTargetInfluences.length,W=F.morphTargetDictionary[f.propertyIndex];if(void 0===W)throw new Error("THREE.GLTFExporter: Morph target name not found: "+f.propertyIndex);let q;if(void 0===u[F.uuid]){q=d.clone();const e=new q.ValueBufferType(V*q.times.length);for(let r=0;r<q.times.length;r++)e[r*V+W]=q.values[r];q.name=(f.nodeName||"")+".morphTargetInfluences",q.values=e,u[F.uuid]=q,l.push(q);continue}const $=d.createInterpolant(new d.ValueBufferType(1));q=u[F.uuid];for(let e=0;e<q.times.length;e++)q.values[e*V+W]=$.evaluate(q.times[e]);for(let e=0;e<d.times.length;e++){const r=this.insertKeyframe(q,d.times[e]);q.values[r*V+W]=d.values[e]}}return e.tracks=l,e}},((e,r,l)=>{r in e?lr(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l})(Uo,"Utils"+"",gr);const vr=0,yr=1,br=2,xr=3,wr=4,Tr=5120,_r=5121,Ar=5122,Mr=5123,Er=5124,Pr=5125,Rr=5126,Ir=34962,Sr=34963,Cr=9728,Lr=9729,Dr=9984,kr=9985,Or=9986,Nr=9987,Ur=33071,jr=33648,zr=10497,Br="KHR_mesh_quantization",Fr={};Fr[At]=Cr,Fr[Tt]=Dr,Fr[xt]=Or,Fr[_t]=Lr,Fr[wt]=kr,Fr[bt]=Nr,Fr[Pt]=Ur,Fr[Mt]=zr,Fr[Et]=jr;const Hr={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Gr=new ot;function vs(e,r){return e.length===r.length&&e.every(function(e,l){return e===r[l]})}function Ba(e){return 4*Math.ceil(e/4)}function Si(e,r=0){const l=Ba(e.byteLength);if(l!==e.byteLength){const u=new Uint8Array(l);if(u.set(new Uint8Array(e)),0!==r)for(let h=e.byteLength;h<l;h++)u[h]=r;return u.buffer}return e}function rr(){return typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):(void 0).createElement("canvas")}function ar(e,r){if(void 0!==e.toBlob)return new Promise(l=>e.toBlob(l,r));let l;return"image/jpeg"===r?l=.92:"image/webp"===r&&(l=.8),e.convertToBlob({type:r,quality:l})}class bu{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,r,l={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},l),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const u=this,h=u.buffers,d=u.json;l=u.options;const f=u.extensionsUsed,F=u.extensionsRequired,V=new Blob(h,{type:"application/octet-stream"}),W=Object.keys(f),q=Object.keys(F);W.length>0&&(d.extensionsUsed=W),q.length>0&&(d.extensionsRequired=q),d.buffers&&d.buffers.length>0&&(d.buffers[0].byteLength=V.size),!0===l.binary?V.arrayBuffer().then(e=>{const l=Si(e),u=new DataView(new ArrayBuffer(8));u.setUint32(0,l.byteLength,!0),u.setUint32(4,5130562,!0);const h=Si(function(e){return(new TextEncoder).encode(e).buffer}(JSON.stringify(d)),32),f=new DataView(new ArrayBuffer(8));f.setUint32(0,h.byteLength,!0),f.setUint32(4,1313821514,!0);const F=new ArrayBuffer(12),V=new DataView(F);V.setUint32(0,1179937895,!0),V.setUint32(4,2,!0);const W=12+f.byteLength+h.byteLength+u.byteLength+l.byteLength;V.setUint32(8,W,!0),new Blob([F,f,h,u,l],{type:"application/octet-stream"}).arrayBuffer().then(r)}):d.buffers&&d.buffers.length>0?tr(V).then(e=>{d.buffers[0].uri=e,r(d)}):r(d)}serializeUserData(e,r){if(0===Object.keys(e.userData).length)return;const l=this.options,u=this.extensionsUsed;try{const h=JSON.parse(JSON.stringify(e.userData));if(l.includeCustomExtensions&&h.gltfExtensions){void 0===r.extensions&&(r.extensions={});for(const e in h.gltfExtensions)r.extensions[e]=h.gltfExtensions[e],u[e]=!0;delete h.gltfExtensions}Object.keys(h).length>0&&(r.extras=h)}catch(e){}}getUID(e,r=!1){if(!1===this.uids.has(e)){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(r)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const r=new Ve;for(let l=0,u=e.count;l<u;l++)if(Math.abs(r.fromBufferAttribute(e,l).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const r=this.cache;if(r.attributesNormalized.has(e))return r.attributesNormalized.get(e);const l=e.clone(),u=new Ve;for(let e=0,r=l.count;e<r;e++)u.fromBufferAttribute(l,e),0===u.x&&0===u.y&&0===u.z?u.setX(1):u.normalize(),l.setXYZ(e,u.x,u.y,u.z);return r.attributesNormalized.set(e,l),l}applyTextureTransform(e,r){let l=!1;const u={};(0!==r.offset.x||0!==r.offset.y)&&(u.offset=r.offset.toArray(),l=!0),0!==r.rotation&&(u.rotation=r.rotation,l=!0),(1!==r.repeat.x||1!==r.repeat.y)&&(u.scale=r.repeat.toArray(),l=!0),l&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=u,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,r){if(e===r)return e;function n(e){return("colorSpace"in e?"srgb"===e.colorSpace:3001===e.encoding)?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}e instanceof Pn&&(e=Ei(e)),r instanceof Pn&&(r=Ei(r));const l=e?e.image:null,u=r?r.image:null,h=Math.max(l?l.width:0,u?u.width:0),d=Math.max(l?l.height:0,u?u.height:0),f=rr();f.width=h,f.height=d;const F=f.getContext("2d");F.fillStyle="#00ffff",F.fillRect(0,0,h,d);const V=F.getImageData(0,0,h,d);if(l){F.drawImage(l,0,0,h,d);const r=n(e),u=F.getImageData(0,0,h,d).data;for(let e=2;e<u.length;e+=4)V.data[e]=256*r(u[e]/256)}if(u){F.drawImage(u,0,0,h,d);const e=n(r),l=F.getImageData(0,0,h,d).data;for(let r=1;r<l.length;r+=4)V.data[r]=256*e(l[r]/256)}F.putImageData(V,0,0);const W=(e||r).clone();return W.source=new Rt(f).source,"colorSpace"in W?W.colorSpace="":W.encoding=3e3,W.channel=(e||r).channel,e&&r&&(e.channel,r.channel),W}processBuffer(e){const r=this.json,l=this.buffers;return r.buffers||(r.buffers=[{byteLength:0}]),l.push(e),0}processBufferView(e,r,l,u,h){const d=this.json;let f;switch(d.bufferViews||(d.bufferViews=[]),r){case Tr:case _r:f=1;break;case Ar:case Mr:f=2;break;default:f=4}const F=Ba(u*e.itemSize*f),V=new DataView(new ArrayBuffer(F));let W=0;for(let h=l;h<l+u;h++)for(let l=0;l<e.itemSize;l++){let u;e.itemSize>4?u=e.array[h*e.itemSize+l]:(0===l?u=e.getX(h):1===l?u=e.getY(h):2===l?u=e.getZ(h):3===l&&(u=e.getW(h)),!0===e.normalized&&(u=Vt.normalize(u,e.array))),r===Rr?V.setFloat32(W,u,!0):r===Er?V.setInt32(W,u,!0):r===Pr?V.setUint32(W,u,!0):r===Ar?V.setInt16(W,u,!0):r===Mr?V.setUint16(W,u,!0):r===Tr?V.setInt8(W,u):r===_r&&V.setUint8(W,u),W+=f}const q={buffer:this.processBuffer(V.buffer),byteOffset:this.byteOffset,byteLength:F};return void 0!==h&&(q.target=h),h===Ir&&(q.byteStride=e.itemSize*f),this.byteOffset+=F,d.bufferViews.push(q),{id:d.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const r=this,l=r.json;return l.bufferViews||(l.bufferViews=[]),e.arrayBuffer().then(e=>{const u=Si(e),h={buffer:r.processBuffer(u),byteOffset:r.byteOffset,byteLength:u.byteLength};return r.byteOffset+=u.byteLength,l.bufferViews.push(h)-1})}processAccessor(e,r,l,u){const h=this.json;let d;if(e.array.constructor===Float32Array)d=Rr;else if(e.array.constructor===Int32Array)d=Er;else if(e.array.constructor===Uint32Array)d=Pr;else if(e.array.constructor===Int16Array)d=Ar;else if(e.array.constructor===Uint16Array)d=Mr;else if(e.array.constructor===Int8Array)d=Tr;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);d=_r}if(void 0===l&&(l=0),void 0===u&&(u=e.count),0===u)return null;const f=function(e,r,l){const u={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let h=r;h<r+l;h++)for(let r=0;r<e.itemSize;r++){let l;e.itemSize>4?l=e.array[h*e.itemSize+r]:(0===r?l=e.getX(h):1===r?l=e.getY(h):2===r?l=e.getZ(h):3===r&&(l=e.getW(h)),!0===e.normalized&&(l=Vt.normalize(l,e.array))),u.min[r]=Math.min(u.min[r],l),u.max[r]=Math.max(u.max[r],l)}return u}(e,l,u);let F;void 0!==r&&(F=e===r.index?Sr:Ir);const V=this.processBufferView(e,d,l,u,F),W={bufferView:V.id,byteOffset:V.byteOffset,componentType:d,count:u,max:f.max,min:f.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(W.normalized=!0),h.accessors||(h.accessors=[]),h.accessors.push(W)-1}processImage(e,r,l,u="image/png"){if(null!==e){const r=this,h=r.cache,d=r.json,f=r.options,F=r.pending;h.images.has(e)||h.images.set(e,{});const V=h.images.get(e),W=u+":flipY/"+l.toString();if(void 0!==V[W])return V[W];d.images||(d.images=[]);const q={mimeType:u},$=rr();$.width=Math.min(e.width,f.maxTextureSize),$.height=Math.min(e.height,f.maxTextureSize);const Q=$.getContext("2d");if(!0===l&&(Q.translate(0,$.height),Q.scale(1,-1)),void 0!==e.data){e.width>f.maxTextureSize||(e.height,f.maxTextureSize);const r=new Uint8ClampedArray(e.height*e.width*4);for(let l=0;l<r.length;l+=4)r[l+0]=e.data[l+0],r[l+1]=e.data[l+1],r[l+2]=e.data[l+2],r[l+3]=e.data[l+3];Q.putImageData(new ImageData(r,e.width,e.height),0,0)}else Q.drawImage(e,0,0,$.width,$.height);!0===f.binary?F.push(ar($,u).then(e=>r.processBufferViewImage(e)).then(e=>{q.bufferView=e})):void 0!==$.toDataURL?q.uri=$.toDataURL(u):F.push(ar($,u).then(tr).then(e=>{q.uri=e}));const J=d.images.push(q)-1;return V[W]=J,J}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const r=this.json;r.samplers||(r.samplers=[]);const l={magFilter:Fr[e.magFilter],minFilter:Fr[e.minFilter],wrapS:Fr[e.wrapS],wrapT:Fr[e.wrapT]};return r.samplers.push(l)-1}processTexture(e){const r=this.options,l=this.cache,u=this.json;if(l.textures.has(e))return l.textures.get(e);u.textures||(u.textures=[]),e instanceof Pn&&(e=Ei(e,r.maxTextureSize));let h=e.userData.mimeType;"image/webp"===h&&(h="image/png");const d={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,h)};e.name&&(d.name=e.name),this._invokeAll(function(r){r.writeTexture&&r.writeTexture(e,d)});const f=u.textures.push(d)-1;return l.textures.set(e,f),f}processMaterial(e){const r=this.cache,l=this.json;if(r.materials.has(e))return r.materials.get(e);if(e.isShaderMaterial)return null;l.materials||(l.materials=[]);const u={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&e.isMeshBasicMaterial;const h=e.color.toArray().concat([e.opacity]);if(vs(h,[1,1,1,1])||(u.pbrMetallicRoughness.baseColorFactor=h),e.isMeshStandardMaterial?(u.pbrMetallicRoughness.metallicFactor=e.metalness,u.pbrMetallicRoughness.roughnessFactor=e.roughness):(u.pbrMetallicRoughness.metallicFactor=.5,u.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const r=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),l={index:this.processTexture(r),channel:r.channel};this.applyTextureTransform(l,r),u.pbrMetallicRoughness.metallicRoughnessTexture=l}if(e.map){const r={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(r,e.map),u.pbrMetallicRoughness.baseColorTexture=r}if(e.emissive){const r=e.emissive;if(Math.max(r.r,r.g,r.b)>0&&(u.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const r={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(r,e.emissiveMap),u.emissiveTexture=r}}if(e.normalMap){const r={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&1!==e.normalScale.x&&(r.scale=e.normalScale.x),this.applyTextureTransform(r,e.normalMap),u.normalTexture=r}if(e.aoMap){const r={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};1!==e.aoMapIntensity&&(r.strength=e.aoMapIntensity),this.applyTextureTransform(r,e.aoMap),u.occlusionTexture=r}e.transparent?u.alphaMode="BLEND":e.alphaTest>0&&(u.alphaMode="MASK",u.alphaCutoff=e.alphaTest),e.side===Dt&&(u.doubleSided=!0),""!==e.name&&(u.name=e.name),this.serializeUserData(e,u),this._invokeAll(function(r){r.writeMaterial&&r.writeMaterial(e,u)});const d=l.materials.push(u)-1;return r.materials.set(e,d),d}processMesh(e){const r=this.cache,l=this.json,u=[e.geometry.uuid];if(Array.isArray(e.material))for(let r=0,l=e.material.length;r<l;r++)u.push(e.material[r].uuid);else u.push(e.material.uuid);const h=u.join(":");if(r.meshes.has(h))return r.meshes.get(h);const d=e.geometry;let f;f=e.isLineSegments?yr:e.isLineLoop?br:e.isLine?xr:e.isPoints?vr:e.material.wireframe?yr:wr;const F={},V={},W=[],q=[],$={...or>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},Q=d.getAttribute("normal");void 0!==Q&&!this.isNormalizedNormalAttribute(Q)&&d.setAttribute("normal",this.createNormalizedNormalAttribute(Q));let J=null;for(let e in d.attributes){if("morph"===e.slice(0,5))continue;const l=d.attributes[e];if(e=$[e]||e.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(e)||(e="_"+e),r.attributes.has(this.getUID(l))){V[e]=r.attributes.get(this.getUID(l));continue}J=null;const u=l.array;"JOINTS_0"===e&&!(u instanceof Uint16Array)&&!(u instanceof Uint8Array)&&(J=new rt(new Uint16Array(u),l.itemSize,l.normalized));const h=this.processAccessor(J||l,d);null!==h&&(e.startsWith("_")||this.detectMeshQuantization(e,l),V[e]=h,r.attributes.set(this.getUID(l),h))}if(void 0!==Q&&d.setAttribute("normal",Q),0===Object.keys(V).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const l=[],u=[],h={};if(void 0!==e.morphTargetDictionary)for(const r in e.morphTargetDictionary)h[e.morphTargetDictionary[r]]=r;for(let f=0;f<e.morphTargetInfluences.length;++f){const F={};for(const e in d.morphAttributes){if("position"!==e&&"normal"!==e)continue;const l=d.morphAttributes[e][f],u=e.toUpperCase(),h=d.attributes[e];if(r.attributes.has(this.getUID(l,!0))){F[u]=r.attributes.get(this.getUID(l,!0));continue}const V=l.clone();if(!d.morphTargetsRelative)for(let e=0,r=l.count;e<r;e++)for(let r=0;r<l.itemSize;r++)0===r&&V.setX(e,l.getX(e)-h.getX(e)),1===r&&V.setY(e,l.getY(e)-h.getY(e)),2===r&&V.setZ(e,l.getZ(e)-h.getZ(e)),3===r&&V.setW(e,l.getW(e)-h.getW(e));F[u]=this.processAccessor(V,d),r.attributes.set(this.getUID(h,!0),F[u])}q.push(F),l.push(e.morphTargetInfluences[f]),void 0!==e.morphTargetDictionary&&u.push(h[f])}F.weights=l,u.length>0&&(F.extras={},F.extras.targetNames=u)}const re=Array.isArray(e.material);if(re&&0===d.groups.length)return null;const oe=re?e.material:[e.material],ae=re?d.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let e=0,l=ae.length;e<l;e++){const l={mode:f,attributes:V};if(this.serializeUserData(d,l),q.length>0&&(l.targets=q),null!==d.index){let u=this.getUID(d.index);(void 0!==ae[e].start||void 0!==ae[e].count)&&(u+=":"+ae[e].start+":"+ae[e].count),r.attributes.has(u)?l.indices=r.attributes.get(u):(l.indices=this.processAccessor(d.index,d,ae[e].start,ae[e].count),r.attributes.set(u,l.indices)),null===l.indices&&delete l.indices}const u=this.processMaterial(oe[ae[e].materialIndex]);null!==u&&(l.material=u),W.push(l)}F.primitives=W,l.meshes||(l.meshes=[]),this._invokeAll(function(r){r.writeMesh&&r.writeMesh(e,F)});const le=l.meshes.push(F)-1;return r.meshes.set(h,le),le}detectMeshQuantization(e,r){if(this.extensionsUsed[Br])return;let l;switch(r.array.constructor){case Int8Array:l="byte";break;case Uint8Array:l="unsigned byte";break;case Int16Array:l="short";break;case Uint16Array:l="unsigned short";break;default:return}r.normalized&&(l+=" normalized");const u=e.split("_",1)[0];fr[u]&&fr[u].includes(l)&&(this.extensionsUsed[Br]=!0,this.extensionsRequired[Br]=!0)}processCamera(e){const r=this.json;r.cameras||(r.cameras=[]);const l=e.isOrthographicCamera,u={type:l?"orthographic":"perspective"};return l?u.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:u.perspective={aspectRatio:e.aspect,yfov:Vt.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(u.name=e.type),r.cameras.push(u)-1}processAnimation(e,r){const l=this.json,u=this.nodeMap;l.animations||(l.animations=[]);const h=(e=Uo.Utils.mergeMorphTargetTracks(e.clone(),r)).tracks,d=[],f=[];for(let e=0;e<h.length;++e){const l=h[e],F=Ot.parseTrackName(l.name);let V=Ot.findNode(r,F.nodeName);const W=Hr[F.propertyName];if("bones"===F.objectName&&(V=!0===V.isSkinnedMesh?V.skeleton.getBoneByName(F.objectIndex):void 0),!V||!W)return null;const q=1;let $,Q=l.values.length/l.times.length;W===Hr.morphTargetInfluences&&(Q/=V.morphTargetInfluences.length),!0===l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?($="CUBICSPLINE",Q/=3):$=l.getInterpolation()===Wt?"STEP":"LINEAR",f.push({input:this.processAccessor(new rt(l.times,q)),output:this.processAccessor(new rt(l.values,Q)),interpolation:$}),d.push({sampler:f.length-1,target:{node:u.get(V),path:W}})}return l.animations.push({name:e.name||"clip_"+l.animations.length,samplers:f,channels:d}),l.animations.length-1}processSkin(e){const r=this.json,l=this.nodeMap,u=r.nodes[l.get(e)],h=e.skeleton;if(void 0===h)return null;const d=e.skeleton.bones[0];if(void 0===d)return null;const f=[],F=new Float32Array(16*h.bones.length),V=new ht;for(let r=0;r<h.bones.length;++r)f.push(l.get(h.bones[r])),V.copy(h.boneInverses[r]),V.multiply(e.bindMatrix).toArray(F,16*r);return void 0===r.skins&&(r.skins=[]),r.skins.push({inverseBindMatrices:this.processAccessor(new rt(F,16)),joints:f,skeleton:l.get(d)}),u.skin=r.skins.length-1}processNode(e){const r=this.json,l=this.options,u=this.nodeMap;r.nodes||(r.nodes=[]);const h={};if(l.trs){const r=e.quaternion.toArray(),l=e.position.toArray(),u=e.scale.toArray();vs(r,[0,0,0,1])||(h.rotation=r),vs(l,[0,0,0])||(h.translation=l),vs(u,[1,1,1])||(h.scale=u)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===function(e){return vs(e.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}(e.matrix)&&(h.matrix=e.matrix.elements);if(""!==e.name&&(h.name=String(e.name)),this.serializeUserData(e,h),e.isMesh||e.isLine||e.isPoints){const r=this.processMesh(e);null!==r&&(h.mesh=r)}else e.isCamera&&(h.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const r=[];for(let u=0,h=e.children.length;u<h;u++){const h=e.children[u];if(h.visible||!1===l.onlyVisible){const e=this.processNode(h);null!==e&&r.push(e)}}r.length>0&&(h.children=r)}this._invokeAll(function(r){r.writeNode&&r.writeNode(e,h)});const d=r.nodes.push(h)-1;return u.set(e,d),d}processScene(e){const r=this.json,l=this.options;r.scenes||(r.scenes=[],r.scene=0);const u={};""!==e.name&&(u.name=e.name),r.scenes.push(u);const h=[];for(let r=0,u=e.children.length;r<u;r++){const u=e.children[r];if(u.visible||!1===l.onlyVisible){const e=this.processNode(u);null!==e&&h.push(e)}}h.length>0&&(u.nodes=h),this.serializeUserData(e,u)}processObjects(e){const r=new Rn;r.name="AuxScene";for(let l=0;l<e.length;l++)r.children.push(e[l]);this.processScene(r)}processInput(e){const r=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(r){r.beforeParse&&r.beforeParse(e)});const l=[];for(let r=0;r<e.length;r++)e[r]instanceof Rn?this.processScene(e[r]):l.push(e[r]);l.length>0&&this.processObjects(l);for(let e=0;e<this.skins.length;++e)this.processSkin(this.skins[e]);for(let l=0;l<r.animations.length;++l)this.processAnimation(r.animations[l],e[0]);this._invokeAll(function(r){r.afterParse&&r.afterParse(e)})}_invokeAll(e){for(let r=0,l=this.plugins.length;r<l;r++)e(this.plugins[r])}}class Eu{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,r){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return;const l=this.writer,u=l.json,h=l.extensionsUsed,d={};e.name&&(d.name=e.name),d.color=e.color.toArray(),d.intensity=e.intensity,e.isDirectionalLight?d.type="directional":e.isPointLight?(d.type="point",e.distance>0&&(d.range=e.distance)):e.isSpotLight&&(d.type="spot",e.distance>0&&(d.range=e.distance),d.spot={},d.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,d.spot.outerConeAngle=e.angle),void 0!==e.decay&&e.decay,e.target&&(e.target.parent!==e||0!==e.target.position.x||0!==e.target.position.y||e.target.position.z),h[this.name]||(u.extensions=u.extensions||{},u.extensions[this.name]={lights:[]},h[this.name]=!0);const f=u.extensions[this.name].lights;f.push(d),r.extensions=r.extensions||{},r.extensions[this.name]={light:f.length-1}}}let Vr=class{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,r){if(!e.isMeshBasicMaterial)return;const l=this.writer.extensionsUsed;r.extensions=r.extensions||{},r.extensions[this.name]={},l[this.name]=!0,r.pbrMetallicRoughness.metallicFactor=0,r.pbrMetallicRoughness.roughnessFactor=.9}},Yr=class{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const l=this.writer,u=l.extensionsUsed,h={};if(h.clearcoatFactor=e.clearcoat,e.clearcoatMap){const r={index:l.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};l.applyTextureTransform(r,e.clearcoatMap),h.clearcoatTexture=r}if(h.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const r={index:l.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};l.applyTextureTransform(r,e.clearcoatRoughnessMap),h.clearcoatRoughnessTexture=r}if(e.clearcoatNormalMap){const r={index:l.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};l.applyTextureTransform(r,e.clearcoatNormalMap),h.clearcoatNormalTexture=r}r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},Xr=class{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const l=this.writer,u=l.extensionsUsed,h={};if(h.iridescenceFactor=e.iridescence,e.iridescenceMap){const r={index:l.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};l.applyTextureTransform(r,e.iridescenceMap),h.iridescenceTexture=r}if(h.iridescenceIor=e.iridescenceIOR,h.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],h.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const r={index:l.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};l.applyTextureTransform(r,e.iridescenceThicknessMap),h.iridescenceThicknessTexture=r}r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},Kr=class{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const l=this.writer,u=l.extensionsUsed,h={};if(h.transmissionFactor=e.transmission,e.transmissionMap){const r={index:l.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};l.applyTextureTransform(r,e.transmissionMap),h.transmissionTexture=r}r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},Wr=class{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const l=this.writer,u=l.extensionsUsed,h={};if(h.thicknessFactor=e.thickness,e.thicknessMap){const r={index:l.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};l.applyTextureTransform(r,e.thicknessMap),h.thicknessTexture=r}h.attenuationDistance=e.attenuationDistance,h.attenuationColor=e.attenuationColor.toArray(),r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},qr=class{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const l=this.writer.extensionsUsed,u={};u.ior=e.ior,r.extensions=r.extensions||{},r.extensions[this.name]=u,l[this.name]=!0}},Zr=class{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(Gr)&&!e.specularIntensityMap&&!e.specularColorTexture)return;const l=this.writer,u=l.extensionsUsed,h={};if(e.specularIntensityMap){const r={index:l.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};l.applyTextureTransform(r,e.specularIntensityMap),h.specularTexture=r}if(e.specularColorMap){const r={index:l.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};l.applyTextureTransform(r,e.specularColorMap),h.specularColorTexture=r}h.specularFactor=e.specularIntensity,h.specularColorFactor=e.specularColor.toArray(),r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},$r=class{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const l=this.writer,u=l.extensionsUsed,h={};if(e.sheenRoughnessMap){const r={index:l.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};l.applyTextureTransform(r,e.sheenRoughnessMap),h.sheenRoughnessTexture=r}if(e.sheenColorMap){const r={index:l.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};l.applyTextureTransform(r,e.sheenColorMap),h.sheenColorTexture=r}h.sheenRoughnessFactor=e.sheenRoughness,h.sheenColorFactor=e.sheenColor.toArray(),r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},Qr=class{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,r){if(!e.isMeshPhysicalMaterial||0==e.anisotropy)return;const l=this.writer,u=l.extensionsUsed,h={};if(e.anisotropyMap){const r={index:l.processTexture(e.anisotropyMap)};l.applyTextureTransform(r,e.anisotropyMap),h.anisotropyTexture=r}h.anisotropyStrength=e.anisotropy,h.anisotropyRotation=e.anisotropyRotation,r.extensions=r.extensions||{},r.extensions[this.name]=h,u[this.name]=!0}},Jr=class{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,r){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const l=this.writer.extensionsUsed,u={};u.emissiveStrength=e.emissiveIntensity,r.extensions=r.extensions||{},r.extensions[this.name]=u,l[this.name]=!0}};var es=Uint8Array,ts=Uint16Array,rs=Uint32Array,ss=new es([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),os=new es([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),za=function(e,r){for(var l=new ts(31),u=0;u<31;++u)l[u]=r+=1<<e[u-1];var h=new rs(l[30]);for(u=1;u<30;++u)for(var d=l[u];d<l[u+1];++d)h[d]=d-l[u]<<5|u;return[l,h]},as=za(ss,2),ls=as[0],cs=as[1];ls[28]=258,cs[258]=28,za(os,0);for(var us=new ts(32768),hs=0;hs<32768;++hs){var ps=(43690&hs)>>>1|(21845&hs)<<1;ps=(61680&(ps=(52428&ps)>>>2|(13107&ps)<<2))>>>4|(3855&ps)<<4,us[hs]=((65280&ps)>>>8|(255&ps)<<8)>>>1}var ds=new es(288);for(hs=0;hs<144;++hs)ds[hs]=8;for(hs=144;hs<256;++hs)ds[hs]=9;for(hs=256;hs<280;++hs)ds[hs]=7;for(hs=280;hs<288;++hs)ds[hs]=8;var fs=new es(32);for(hs=0;hs<32;++hs)fs[hs]=5;var ms=new es(0),gs=typeof TextDecoder<"u"&&new TextDecoder;try{gs.decode(ms,{stream:!0})}catch{}var ys=Object.defineProperty;const bs=class extends jt{constructor(e,r={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new $e;const l=this,u=void 0!==r.color?new ot(r.color):new ot(8355711),h=r.textureWidth||512,d=r.textureHeight||512,f=r.clipBias||0,F=r.shader||bs.ReflectorShader,V=void 0!==r.multisample?r.multisample:4,W=new Je,q=new Ve,$=new Ve,Q=new Ve,J=new ht,re=new Ve(0,0,-1),oe=new vn,ae=new Ve,le=new Ve,ce=new vn,ue=new ht,de=this.camera,ge=new Tn(h,d,{samples:V,type:_n}),ve=new hn({uniforms:dn.clone(F.uniforms),fragmentShader:F.fragmentShader,vertexShader:F.vertexShader});ve.uniforms.tDiffuse.value=ge.texture,ve.uniforms.color.value=u,ve.uniforms.textureMatrix.value=ue,this.material=ve,this.onBeforeRender=function(e,r,u){if($.setFromMatrixPosition(l.matrixWorld),Q.setFromMatrixPosition(u.matrixWorld),J.extractRotation(l.matrixWorld),q.set(0,0,1),q.applyMatrix4(J),ae.subVectors($,Q),ae.dot(q)>0)return;ae.reflect(q).negate(),ae.add($),J.extractRotation(u.matrixWorld),re.set(0,0,-1),re.applyMatrix4(J),re.add(Q),le.subVectors($,re),le.reflect(q).negate(),le.add($),de.position.copy(ae),de.up.set(0,1,0),de.up.applyMatrix4(J),de.up.reflect(q),de.lookAt(le),de.far=u.far,de.updateMatrixWorld(),de.projectionMatrix.copy(u.projectionMatrix),ue.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ue.multiply(de.projectionMatrix),ue.multiply(de.matrixWorldInverse),ue.multiply(l.matrixWorld),W.setFromNormalAndCoplanarPoint(q,$),W.applyMatrix4(de.matrixWorldInverse),oe.set(W.normal.x,W.normal.y,W.normal.z,W.constant);const h=de.projectionMatrix;ce.x=(Math.sign(oe.x)+h.elements[8])/h.elements[0],ce.y=(Math.sign(oe.y)+h.elements[9])/h.elements[5],ce.z=-1,ce.w=(1+h.elements[10])/h.elements[14],oe.multiplyScalar(2/oe.dot(ce)),h.elements[2]=oe.x,h.elements[6]=oe.y,h.elements[10]=oe.z+1-f,h.elements[14]=oe.w,l.visible=!1;const d=e.getRenderTarget(),F=e.xr.enabled,V=e.shadowMap.autoUpdate,ve=e.toneMapping;let ye=!1;ye="outputColorSpace"in e?"srgb"===e.outputColorSpace:3001===e.outputEncoding,e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,"outputColorSpace"in e?e.outputColorSpace="srgb-linear":e.outputEncoding=3e3,e.toneMapping=Mn,e.setRenderTarget(ge),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(r,de),e.xr.enabled=F,e.shadowMap.autoUpdate=V,e.toneMapping=ve,"outputColorSpace"in e?e.outputColorSpace=ye?"srgb":"srgb-linear":e.outputEncoding=ye?3001:3e3,e.setRenderTarget(d);const be=u.viewport;void 0!==be&&e.state.viewport(be),l.visible=!0},this.getRenderTarget=function(){return ge},this.dispose=function(){ge.dispose(),l.material.dispose()}}};let xs=bs;((e,r,l)=>{((e,r,l)=>{r in e?ys(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l})(e,r+"",l)})(xs,"ReflectorShader",{uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:"\n\t\tuniform mat4 textureMatrix;\n\t\tvarying vec4 vUv;\n\n\t\t#include <common>\n\t\t#include <logdepthbuf_pars_vertex>\n\n\t\tvoid main() {\n\n\t\t\tvUv = textureMatrix * vec4( position, 1.0 );\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t\t#include <logdepthbuf_vertex>\n\n\t\t}",fragmentShader:`\n\t\tuniform vec3 color;\n\t\tuniform sampler2D tDiffuse;\n\t\tvarying vec4 vUv;\n\n\t\t#include <logdepthbuf_pars_fragment>\n\n\t\tfloat blendOverlay( float base, float blend ) {\n\n\t\t\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );\n\n\t\t}\n\n\t\tvec3 blendOverlay( vec3 base, vec3 blend ) {\n\n\t\t\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <logdepthbuf_fragment>\n\n\t\t\tvec4 base = texture2DProj( tDiffuse, vUv );\n\t\t\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <${or>=154?"colorspace_fragment":"encodings_fragment"}>\n\n\t\t}`});var ws=Object.defineProperty,Ya=(e,r,l)=>(((e,r,l)=>{r in e?ws(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l})(e,"symbol"!=typeof r?r+"":r,l),l);const Ts=new nt,_s=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),As=new vt(_s,5);Ts.setIndex([0,1,2,0,2,3]),Ts.setAttribute("position",new yt(As,3,0,!1)),Ts.setAttribute("uv",new yt(As,2,3,!1));const Ms=class extends jt{constructor(){super(Ms.Geometry,new kt({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new Ve,r=new Ve,l=new In(new Uint8Array(768),16,16,Sn);l.minFilter=At,l.magFilter=At,l.wrapS=Pt,l.wrapT=Pt;const u=new In(new Uint8Array(768),16,16,Sn);u.minFilter=At,u.magFilter=At,u.wrapS=Pt,u.wrapT=Pt;const h=Ms.Geometry,d=new Cn({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}",fragmentShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );\n\n\t\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),f=new Cn({uniforms:{map:{value:l},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform vec3 screenPosition;\n\t\t\t\tuniform vec2 scale;\n\n\t\t\t\tattribute vec3 position;\n\t\t\t\tattribute vec2 uv;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvUV = uv;\n\n\t\t\t\t\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );\n\n\t\t\t\t}",fragmentShader:"\n\n\t\t\t\tprecision highp float;\n\n\t\t\t\tuniform sampler2D map;\n\n\t\t\t\tvarying vec2 vUV;\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tgl_FragColor = texture2D( map, vUV );\n\n\t\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),F=new jt(h,d),V=[],W=$a.Shader,q=new Cn({uniforms:{map:{value:null},occlusionMap:{value:u},color:{value:new ot(16777215)},scale:{value:new Ze},screenPosition:{value:new Ve}},vertexShader:W.vertexShader,fragmentShader:W.fragmentShader,blending:Ln,transparent:!0,depthWrite:!1}),$=new jt(h,q);this.addElement=function(e){V.push(e)};const Q=new Ze,J=new Ze,re=new kn,oe=new vn;this.onBeforeRender=function(W,ae,le){W.getCurrentViewport(oe);const ce=oe.w/oe.z,ue=oe.z/2,de=oe.w/2;let ge=16/oe.w;if(Q.set(ge*ce,ge),re.min.set(oe.x,oe.y),re.max.set(oe.x+(oe.z-16),oe.y+(oe.w-16)),r.setFromMatrixPosition(this.matrixWorld),r.applyMatrix4(le.matrixWorldInverse),!(r.z>0)&&(e.copy(r).applyMatrix4(le.projectionMatrix),J.x=oe.x+e.x*ue+ue-8,J.y=oe.y+e.y*de+de-8,re.containsPoint(J))){W.copyFramebufferToTexture(J,l);let r=d.uniforms;r.scale.value=Q,r.screenPosition.value=e,W.renderBufferDirect(le,null,h,d,F,null),W.copyFramebufferToTexture(J,u),r=f.uniforms,r.scale.value=Q,r.screenPosition.value=e,W.renderBufferDirect(le,null,h,f,F,null);const re=2*-e.x,ae=2*-e.y;for(let r=0,l=V.length;r<l;r++){const l=V[r],u=q.uniforms;u.color.value.copy(l.color),u.map.value=l.texture,u.screenPosition.value.x=e.x+re*l.distance,u.screenPosition.value.y=e.y+ae*l.distance,ge=l.size/oe.w;const d=oe.w/oe.z;u.scale.value.set(ge*d,ge),q.uniformsNeedUpdate=!0,W.renderBufferDirect(le,null,h,q,$,null)}}},this.dispose=function(){d.dispose(),f.dispose(),q.dispose(),l.dispose(),u.dispose();for(let e=0,r=V.length;e<r;e++)V[e].texture.dispose()}}};Ya(Ms,"Geometry",Ts);class $a{constructor(e,r=1,l=0,u=new ot(16777215)){this.texture=e,this.size=r,this.distance=l,this.color=u}}Ya($a,"Shader",{uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform vec3 screenPosition;\n\t\tuniform vec2 scale;\n\n\t\tuniform sampler2D occlusionMap;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvUV = uv;\n\n\t\t\tvec2 pos = position.xy;\n\n\t\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\n\t\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\n\n\t\t\tvVisibility =        visibility.r / 9.0;\n\t\t\tvVisibility *= 1.0 - visibility.g / 9.0;\n\t\t\tvVisibility *=       visibility.b / 9.0;\n\n\t\t\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tprecision highp float;\n\n\t\tuniform sampler2D map;\n\t\tuniform vec3 color;\n\n\t\tvarying vec2 vUV;\n\t\tvarying float vVisibility;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texture = texture2D( map, vUV );\n\t\t\ttexture.a *= vVisibility;\n\t\t\tgl_FragColor = texture;\n\t\t\tgl_FragColor.rgb *= color;\n\n\t\t}"});var Es=Object.defineProperty,Za=(e,r,l)=>(((e,r,l)=>{r in e?Es(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l})(e,"symbol"!=typeof r?r+"":r,l),l);const Rs={uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Ve},up:{value:new Ve(0,1,0)}},vertexShader:"\n      uniform vec3 sunPosition;\n      uniform float rayleigh;\n      uniform float turbidity;\n      uniform float mieCoefficient;\n      uniform vec3 up;\n\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      // constants for atmospheric scattering\n      const float e = 2.71828182845904523536028747135266249775724709369995957;\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      // wavelength of used primaries, according to preetham\n      const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\n      // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n      // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n      const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\n\n      // mie stuff\n      // K coefficient for the primaries\n      const float v = 4.0;\n      const vec3 K = vec3( 0.686, 0.678, 0.666 );\n      // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n      const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\n\n      // earth shadow hack\n      // cutoffAngle = pi / 1.95;\n      const float cutoffAngle = 1.6110731556870734;\n      const float steepness = 1.5;\n      const float EE = 1000.0;\n\n      float sunIntensity( float zenithAngleCos ) {\n        zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\n        return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\n      }\n\n      vec3 totalMie( float T ) {\n        float c = ( 0.2 * T ) * 10E-18;\n        return 0.434 * c * MieConst;\n      }\n\n      void main() {\n\n        vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n        vWorldPosition = worldPosition.xyz;\n\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        gl_Position.z = gl_Position.w; // set z to camera.far\n\n        vSunDirection = normalize( sunPosition );\n\n        vSunE = sunIntensity( dot( vSunDirection, up ) );\n\n        vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\n\n        float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\n\n      // extinction (absorbtion + out scattering)\n      // rayleigh coefficients\n        vBetaR = totalRayleigh * rayleighCoefficient;\n\n      // mie coefficients\n        vBetaM = totalMie( turbidity ) * mieCoefficient;\n\n      }\n    ",fragmentShader:`\n      varying vec3 vWorldPosition;\n      varying vec3 vSunDirection;\n      varying float vSunfade;\n      varying vec3 vBetaR;\n      varying vec3 vBetaM;\n      varying float vSunE;\n\n      uniform float mieDirectionalG;\n      uniform vec3 up;\n\n      const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\n\n      // constants for atmospheric scattering\n      const float pi = 3.141592653589793238462643383279502884197169;\n\n      const float n = 1.0003; // refractive index of air\n      const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)\n\n      // optical length at zenith for molecules\n      const float rayleighZenithLength = 8.4E3;\n      const float mieZenithLength = 1.25E3;\n      // 66 arc seconds -> degrees, and the cosine of that\n      const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\n\n      // 3.0 / ( 16.0 * pi )\n      const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\n      // 1.0 / ( 4.0 * pi )\n      const float ONE_OVER_FOURPI = 0.07957747154594767;\n\n      float rayleighPhase( float cosTheta ) {\n        return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\n      }\n\n      float hgPhase( float cosTheta, float g ) {\n        float g2 = pow( g, 2.0 );\n        float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\n        return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\n      }\n\n      void main() {\n\n        vec3 direction = normalize( vWorldPosition - cameraPos );\n\n      // optical length\n      // cutoff angle at 90 to avoid singularity in next formula.\n        float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );\n        float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\n        float sR = rayleighZenithLength * inverse;\n        float sM = mieZenithLength * inverse;\n\n      // combined extinction factor\n        vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\n\n      // in scattering\n        float cosTheta = dot( direction, vSunDirection );\n\n        float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\n        vec3 betaRTheta = vBetaR * rPhase;\n\n        float mPhase = hgPhase( cosTheta, mieDirectionalG );\n        vec3 betaMTheta = vBetaM * mPhase;\n\n        vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\n        Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\n\n      // nightsky\n        float theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]\n        float phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]\n        vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\n        vec3 L0 = vec3( 0.1 ) * Fex;\n\n      // composition + solar disc\n        float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\n        L0 += ( vSunE * 19000.0 * Fex ) * sundisk;\n\n        vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\n\n        vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\n\n        gl_FragColor = vec4( retColor, 1.0 );\n\n      #include <tonemapping_fragment>\n      #include <${or>=154?"colorspace_fragment":"encodings_fragment"}>\n\n      }\n    `},Ss=new hn({name:"SkyShader",fragmentShader:Rs.fragmentShader,vertexShader:Rs.vertexShader,uniforms:dn.clone(Rs.uniforms),side:pn,depthWrite:!1});class Fo extends jt{constructor(){super(new xn(1,1,1),Ss)}}Za(Fo,"SkyShader",Rs),Za(Fo,"material",Ss),new fn,new Ve,new mn(0,0,0,"YXZ"),new Ve;var Cs=Object.defineProperty,_e=(e,r,l)=>(((e,r,l)=>{r in e?Cs(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l})(e,"symbol"!=typeof r?r+"":r,l),l);const Ls=new Qe,Ds=new Je,ks=Math.cos(Math.PI/180*70),ur=(e,r)=>(e%r+r)%r;class Qa extends Fe{constructor(e,r){super(),_e(this,"object"),_e(this,"domElement"),_e(this,"enabled",!0),_e(this,"target",new Ve),_e(this,"minDistance",0),_e(this,"maxDistance",1/0),_e(this,"minZoom",0),_e(this,"maxZoom",1/0),_e(this,"minPolarAngle",0),_e(this,"maxPolarAngle",Math.PI),_e(this,"minAzimuthAngle",-1/0),_e(this,"maxAzimuthAngle",1/0),_e(this,"enableDamping",!1),_e(this,"dampingFactor",.05),_e(this,"enableZoom",!0),_e(this,"zoomSpeed",1),_e(this,"enableRotate",!0),_e(this,"rotateSpeed",1),_e(this,"enablePan",!0),_e(this,"panSpeed",1),_e(this,"screenSpacePanning",!0),_e(this,"keyPanSpeed",7),_e(this,"zoomToCursor",!1),_e(this,"autoRotate",!1),_e(this,"autoRotateSpeed",2),_e(this,"reverseOrbit",!1),_e(this,"reverseHorizontalOrbit",!1),_e(this,"reverseVerticalOrbit",!1),_e(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),_e(this,"mouseButtons",{LEFT:je.ROTATE,MIDDLE:je.DOLLY,RIGHT:je.PAN}),_e(this,"touches",{ONE:ze.ROTATE,TWO:ze.DOLLY_PAN}),_e(this,"target0"),_e(this,"position0"),_e(this,"zoom0"),_e(this,"_domElementKeyEvents",null),_e(this,"getPolarAngle"),_e(this,"getAzimuthalAngle"),_e(this,"setPolarAngle"),_e(this,"setAzimuthalAngle"),_e(this,"getDistance"),_e(this,"getZoomScale"),_e(this,"listenToKeyEvents"),_e(this,"stopListenToKeyEvents"),_e(this,"saveState"),_e(this,"reset"),_e(this,"update"),_e(this,"connect"),_e(this,"dispose"),_e(this,"dollyIn"),_e(this,"dollyOut"),_e(this,"getScale"),_e(this,"setScale"),this.object=e,this.domElement=r,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>W.phi,this.getAzimuthalAngle=()=>W.theta,this.setPolarAngle=e=>{let r=ur(e,2*Math.PI),u=W.phi;u<0&&(u+=2*Math.PI),r<0&&(r+=2*Math.PI);let h=Math.abs(r-u);2*Math.PI-h<h&&(r<u?r+=2*Math.PI:u+=2*Math.PI),q.phi=r-u,l.update()},this.setAzimuthalAngle=e=>{let r=ur(e,2*Math.PI),u=W.theta;u<0&&(u+=2*Math.PI),r<0&&(r+=2*Math.PI);let h=Math.abs(r-u);2*Math.PI-h<h&&(r<u?r+=2*Math.PI:u+=2*Math.PI),q.theta=r-u,l.update()},this.getDistance=()=>l.object.position.distanceTo(l.target),this.listenToKeyEvents=e=>{e.addEventListener("keydown",Nt),this._domElementKeyEvents=e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Nt),this._domElementKeyEvents=null},this.saveState=()=>{l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=()=>{l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(u),l.update(),F=f.NONE},this.update=(()=>{const r=new Ve,h=new Ve(0,1,0),d=(new We).setFromUnitVectors(e.up,h),J=d.clone().invert(),re=new Ve,oe=new We,ae=2*Math.PI;return function(){const le=l.object.position;d.setFromUnitVectors(e.up,h),J.copy(d).invert(),r.copy(le).sub(l.target),r.applyQuaternion(d),W.setFromVector3(r),l.autoRotate&&F===f.NONE&&U(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(W.theta+=q.theta*l.dampingFactor,W.phi+=q.phi*l.dampingFactor):(W.theta+=q.theta,W.phi+=q.phi);let ce=l.minAzimuthAngle,ue=l.maxAzimuthAngle;isFinite(ce)&&isFinite(ue)&&(ce<-Math.PI?ce+=ae:ce>Math.PI&&(ce-=ae),ue<-Math.PI?ue+=ae:ue>Math.PI&&(ue-=ae),W.theta=ce<=ue?Math.max(ce,Math.min(ue,W.theta)):W.theta>(ce+ue)/2?Math.max(ce,W.theta):Math.min(ue,W.theta)),W.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,W.phi)),W.makeSafe(),!0===l.enableDamping?l.target.addScaledVector(Q,l.dampingFactor):l.target.add(Q),l.zoomToCursor&&be||l.object.isOrthographicCamera?W.radius=we(W.radius):W.radius=we(W.radius*$),r.setFromSpherical(W),r.applyQuaternion(J),le.copy(l.target).add(r),l.object.matrixAutoUpdate||l.object.updateMatrix(),l.object.lookAt(l.target),!0===l.enableDamping?(q.theta*=1-l.dampingFactor,q.phi*=1-l.dampingFactor,Q.multiplyScalar(1-l.dampingFactor)):(q.set(0,0,0),Q.set(0,0,0));let de=!1;if(l.zoomToCursor&&be){let u=null;if(l.object instanceof $e&&l.object.isPerspectiveCamera){const e=r.length();u=we(e*$);const h=e-u;l.object.position.addScaledVector(ve,h),l.object.updateMatrixWorld()}else if(l.object.isOrthographicCamera){const e=new Ve(ye.x,ye.y,0);e.unproject(l.object),l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/$)),l.object.updateProjectionMatrix(),de=!0;const h=new Ve(ye.x,ye.y,0);h.unproject(l.object),l.object.position.sub(h).add(e),l.object.updateMatrixWorld(),u=r.length()}else l.zoomToCursor=!1;null!==u&&(l.screenSpacePanning?l.target.set(0,0,-1).transformDirection(l.object.matrix).multiplyScalar(u).add(l.object.position):(Ls.origin.copy(l.object.position),Ls.direction.set(0,0,-1).transformDirection(l.object.matrix),Math.abs(l.object.up.dot(Ls.direction))<ks?e.lookAt(l.target):(Ds.setFromNormalAndCoplanarPoint(l.object.up,l.target),Ls.intersectPlane(Ds,l.target))))}else l.object instanceof qe&&l.object.isOrthographicCamera&&(de=1!==$,de&&(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/$)),l.object.updateProjectionMatrix()));return $=1,be=!1,!!(de||re.distanceToSquared(l.object.position)>V||8*(1-oe.dot(l.object.quaternion))>V)&&(l.dispatchEvent(u),re.copy(l.object.position),oe.copy(l.object.quaternion),de=!1,!0)}})(),this.connect=e=>{l.domElement=e,l.domElement.style.touchAction="none",l.domElement.addEventListener("contextmenu",is),l.domElement.addEventListener("pointerdown",Re),l.domElement.addEventListener("pointercancel",He),l.domElement.addEventListener("wheel",En)},this.dispose=()=>{var e,r,u,h,d,f;l.domElement&&(l.domElement.style.touchAction="auto"),null==(e=l.domElement)||e.removeEventListener("contextmenu",is),null==(r=l.domElement)||r.removeEventListener("pointerdown",Re),null==(u=l.domElement)||u.removeEventListener("pointercancel",He),null==(h=l.domElement)||h.removeEventListener("wheel",En),null==(d=l.domElement)||d.ownerDocument.removeEventListener("pointermove",Ke),null==(f=l.domElement)||f.ownerDocument.removeEventListener("pointerup",He),null!==l._domElementKeyEvents&&l._domElementKeyEvents.removeEventListener("keydown",Nt)};const l=this,u={type:"change"},h={type:"start"},d={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let F=f.NONE;const V=1e-6,W=new Ye,q=new Ye;let $=1;const Q=new Ve,J=new Ze,re=new Ze,oe=new Ze,ae=new Ze,le=new Ze,ce=new Ze,ue=new Ze,de=new Ze,ge=new Ze,ve=new Ve,ye=new Ze;let be=!1;const xe=[],Te={};function N(){return Math.pow(.95,l.zoomSpeed)}function U(e){l.reverseOrbit||l.reverseHorizontalOrbit?q.theta+=e:q.theta-=e}function Y(e){l.reverseOrbit||l.reverseVerticalOrbit?q.phi+=e:q.phi-=e}const Ae=(()=>{const e=new Ve;return function(r,l){e.setFromMatrixColumn(l,0),e.multiplyScalar(-r),Q.add(e)}})(),Me=(()=>{const e=new Ve;return function(r,u){!0===l.screenSpacePanning?e.setFromMatrixColumn(u,1):(e.setFromMatrixColumn(u,0),e.crossVectors(l.object.up,e)),e.multiplyScalar(r),Q.add(e)}})(),Ee=(()=>{const e=new Ve;return function(r,u){const h=l.domElement;if(h&&l.object instanceof $e&&l.object.isPerspectiveCamera){const d=l.object.position;e.copy(d).sub(l.target);let f=e.length();f*=Math.tan(l.object.fov/2*Math.PI/180),Ae(2*r*f/h.clientHeight,l.object.matrix),Me(2*u*f/h.clientHeight,l.object.matrix)}else h&&l.object instanceof qe&&l.object.isOrthographicCamera?(Ae(r*(l.object.right-l.object.left)/l.object.zoom/h.clientWidth,l.object.matrix),Me(u*(l.object.top-l.object.bottom)/l.object.zoom/h.clientHeight,l.object.matrix)):l.enablePan=!1}})();function ee(e){l.object instanceof $e&&l.object.isPerspectiveCamera||l.object instanceof qe&&l.object.isOrthographicCamera?$=e:l.enableZoom=!1}function te(e){ee($/e)}function fe(e){ee($*e)}function he(e){if(!l.zoomToCursor||!l.domElement)return;be=!0;const r=l.domElement.getBoundingClientRect(),u=e.clientX-r.left,h=e.clientY-r.top,d=r.width,f=r.height;ye.x=u/d*2-1,ye.y=-h/f*2+1,ve.set(ye.x,ye.y,1).unproject(l.object).sub(l.object.position).normalize()}function we(e){return Math.max(l.minDistance,Math.min(l.maxDistance,e))}function I(e){J.set(e.clientX,e.clientY)}function D(e){ae.set(e.clientX,e.clientY)}function X(){if(1==xe.length)J.set(xe[0].pageX,xe[0].pageY);else{const e=.5*(xe[0].pageX+xe[1].pageX),r=.5*(xe[0].pageY+xe[1].pageY);J.set(e,r)}}function H(){if(1==xe.length)ae.set(xe[0].pageX,xe[0].pageY);else{const e=.5*(xe[0].pageX+xe[1].pageX),r=.5*(xe[0].pageY+xe[1].pageY);ae.set(e,r)}}function j(){const e=xe[0].pageX-xe[1].pageX,r=xe[0].pageY-xe[1].pageY,l=Math.sqrt(e*e+r*r);ue.set(0,l)}function ie(e){if(1==xe.length)re.set(e.pageX,e.pageY);else{const r=pi(e),l=.5*(e.pageX+r.x),u=.5*(e.pageY+r.y);re.set(l,u)}oe.subVectors(re,J).multiplyScalar(l.rotateSpeed);const r=l.domElement;r&&(U(2*Math.PI*oe.x/r.clientHeight),Y(2*Math.PI*oe.y/r.clientHeight)),J.copy(re)}function G(e){if(1==xe.length)le.set(e.pageX,e.pageY);else{const r=pi(e),l=.5*(e.pageX+r.x),u=.5*(e.pageY+r.y);le.set(l,u)}ce.subVectors(le,ae).multiplyScalar(l.panSpeed),Ee(ce.x,ce.y),ae.copy(le)}function k(e){const r=pi(e),u=e.pageX-r.x,h=e.pageY-r.y,d=Math.sqrt(u*u+h*h);de.set(0,d),ge.set(0,Math.pow(de.y/ue.y,l.zoomSpeed)),te(ge.y),ue.copy(de)}function Re(e){var r,u;!1!==l.enabled&&(0===xe.length&&(null==(r=l.domElement)||r.ownerDocument.addEventListener("pointermove",Ke),null==(u=l.domElement)||u.ownerDocument.addEventListener("pointerup",He)),function(e){xe.push(e)}(e),"touch"===e.pointerType?function(e){switch(Is(e),xe.length){case 1:switch(l.touches.ONE){case ze.ROTATE:if(!1===l.enableRotate)return;X(),F=f.TOUCH_ROTATE;break;case ze.PAN:if(!1===l.enablePan)return;H(),F=f.TOUCH_PAN;break;default:F=f.NONE}break;case 2:switch(l.touches.TWO){case ze.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;l.enableZoom&&j(),l.enablePan&&H(),F=f.TOUCH_DOLLY_PAN;break;case ze.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;l.enableZoom&&j(),l.enableRotate&&X(),F=f.TOUCH_DOLLY_ROTATE;break;default:F=f.NONE}break;default:F=f.NONE}F!==f.NONE&&l.dispatchEvent(h)}(e):function(e){let r;switch(e.button){case 0:r=l.mouseButtons.LEFT;break;case 1:r=l.mouseButtons.MIDDLE;break;case 2:r=l.mouseButtons.RIGHT;break;default:r=-1}switch(r){case je.DOLLY:if(!1===l.enableZoom)return;(function(e){he(e),ue.set(e.clientX,e.clientY)})(e),F=f.DOLLY;break;case je.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enablePan)return;D(e),F=f.PAN}else{if(!1===l.enableRotate)return;I(e),F=f.ROTATE}break;case je.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===l.enableRotate)return;I(e),F=f.ROTATE}else{if(!1===l.enablePan)return;D(e),F=f.PAN}break;default:F=f.NONE}F!==f.NONE&&l.dispatchEvent(h)}(e))}function Ke(e){!1!==l.enabled&&("touch"===e.pointerType?function(e){switch(Is(e),F){case f.TOUCH_ROTATE:if(!1===l.enableRotate)return;ie(e),l.update();break;case f.TOUCH_PAN:if(!1===l.enablePan)return;G(e),l.update();break;case f.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;(function(e){l.enableZoom&&k(e),l.enablePan&&G(e)})(e),l.update();break;case f.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;(function(e){l.enableZoom&&k(e),l.enableRotate&&ie(e)})(e),l.update();break;default:F=f.NONE}}(e):function(e){if(!1!==l.enabled)switch(F){case f.ROTATE:if(!1===l.enableRotate)return;!function(e){re.set(e.clientX,e.clientY),oe.subVectors(re,J).multiplyScalar(l.rotateSpeed);const r=l.domElement;r&&(U(2*Math.PI*oe.x/r.clientHeight),Y(2*Math.PI*oe.y/r.clientHeight)),J.copy(re),l.update()}(e);break;case f.DOLLY:if(!1===l.enableZoom)return;!function(e){de.set(e.clientX,e.clientY),ge.subVectors(de,ue),ge.y>0?te(N()):ge.y<0&&fe(N()),ue.copy(de),l.update()}(e);break;case f.PAN:if(!1===l.enablePan)return;!function(e){le.set(e.clientX,e.clientY),ce.subVectors(le,ae).multiplyScalar(l.panSpeed),Ee(ce.x,ce.y),ae.copy(le),l.update()}(e)}}(e))}function He(e){var r,u,h;(function(e){delete Te[e.pointerId];for(let r=0;r<xe.length;r++)if(xe[r].pointerId==e.pointerId)return void xe.splice(r,1)})(e),0===xe.length&&(null==(r=l.domElement)||r.releasePointerCapture(e.pointerId),null==(u=l.domElement)||u.ownerDocument.removeEventListener("pointermove",Ke),null==(h=l.domElement)||h.ownerDocument.removeEventListener("pointerup",He)),l.dispatchEvent(d),F=f.NONE}function En(e){!1===l.enabled||!1===l.enableZoom||F!==f.NONE&&F!==f.ROTATE||(e.preventDefault(),l.dispatchEvent(h),function(e){he(e),e.deltaY<0?fe(N()):e.deltaY>0&&te(N()),l.update()}(e),l.dispatchEvent(d))}function Nt(e){!1===l.enabled||!1===l.enablePan||function(e){let r=!1;switch(e.code){case l.keys.UP:Ee(0,l.keyPanSpeed),r=!0;break;case l.keys.BOTTOM:Ee(0,-l.keyPanSpeed),r=!0;break;case l.keys.LEFT:Ee(l.keyPanSpeed,0),r=!0;break;case l.keys.RIGHT:Ee(-l.keyPanSpeed,0),r=!0}r&&(e.preventDefault(),l.update())}(e)}function is(e){!1!==l.enabled&&e.preventDefault()}function Is(e){let r=Te[e.pointerId];void 0===r&&(r=new Ze,Te[e.pointerId]=r),r.set(e.pageX,e.pageY)}function pi(e){const r=e.pointerId===xe[0].pointerId?xe[1]:xe[0];return Te[r.pointerId]}this.dollyIn=(e=N())=>{fe(e),l.update()},this.dollyOut=(e=N())=>{te(e),l.update()},this.getScale=()=>$,this.setScale=e=>{ee(e),l.update()},this.getZoomScale=()=>N(),void 0!==r&&this.connect(r),this.update()}}function ns(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let r="";for(let l=0,u=e.length;l<u;l++)r+=String.fromCharCode(e[l]);try{return decodeURIComponent(escape(r))}catch{return r}}const Os="srgb",Ns="srgb-linear";class xh extends et{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new Mh(e)}),this.register(function(e){return new Sh(e)}),this.register(function(e){return new kh(e)}),this.register(function(e){return new Nh(e)}),this.register(function(e){return new Bh(e)}),this.register(function(e){return new Ph(e)}),this.register(function(e){return new Rh(e)}),this.register(function(e){return new Ch(e)}),this.register(function(e){return new Ih(e)}),this.register(function(e){return new Eh(e)}),this.register(function(e){return new Oh(e)}),this.register(function(e){return new Ah(e)}),this.register(function(e){return new Lh(e)}),this.register(function(e){return new Dh(e)}),this.register(function(e){return new Th(e)}),this.register(function(e){return new Uh(e)}),this.register(function(e){return new Fh(e)})}load(e,r,l,u){const h=this;let d;if(""!==this.resourcePath)d=this.resourcePath;else if(""!==this.path){const r=st.extractUrlBase(e);d=st.resolveURL(r,this.path)}else d=st.extractUrlBase(e);this.manager.itemStart(e);const a=function(r){u&&u(r),h.manager.itemError(e),h.manager.itemEnd(e)},f=new tt(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(l){try{h.parse(l,d,function(l){r(l),h.manager.itemEnd(e)},a)}catch(e){a(e)}},l,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,r,l,u){let h;const d={},f={};if("string"==typeof e)h=JSON.parse(e);else if(e instanceof ArrayBuffer)if(ns(new Uint8Array(e.slice(0,4)))===js){try{d[Us.KHR_BINARY_GLTF]=new zh(e)}catch(e){return void(u&&u(e))}h=JSON.parse(d[Us.KHR_BINARY_GLTF].content)}else h=JSON.parse(ns(new Uint8Array(e)));else h=e;if(void 0===h.asset||h.asset.version[0]<2)return void(u&&u(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const F=new Jh(h,{path:r||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});F.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const r=this.pluginCallbacks[e](F);r.name,f[r.name]=r,d[r.name]=!0}if(h.extensionsUsed)for(let e=0;e<h.extensionsUsed.length;++e){const r=h.extensionsUsed[e],l=h.extensionsRequired||[];switch(r){case Us.KHR_MATERIALS_UNLIT:d[r]=new bh;break;case Us.KHR_DRACO_MESH_COMPRESSION:d[r]=new Gh(h,this.dracoLoader);break;case Us.KHR_TEXTURE_TRANSFORM:d[r]=new Hh;break;case Us.KHR_MESH_QUANTIZATION:d[r]=new jh;break;default:l.indexOf(r)>=0&&f[r]}}F.setExtensions(d),F.setPlugins(f),F.parse(l,u)}parseAsync(e,r){const l=this;return new Promise(function(u,h){l.parse(e,r,u,h)})}}function wh(){let e={};return{get:function(r){return e[r]},add:function(r,l){e[r]=l},remove:function(r){delete e[r]},removeAll:function(){e={}}}}const Us={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Th{constructor(e){this.parser=e,this.name=Us.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,r=this.parser.json.nodes||[];for(let l=0,u=r.length;l<u;l++){const u=r[l];u.extensions&&u.extensions[this.name]&&void 0!==u.extensions[this.name].light&&e._addNodeRef(this.cache,u.extensions[this.name].light)}}_loadLight(e){const r=this.parser,l="light:"+e;let u=r.cache.get(l);if(u)return u;const h=r.json,d=((h.extensions&&h.extensions[this.name]||{}).lights||[])[e];let f;const F=new ot(16777215);void 0!==d.color&&F.setRGB(d.color[0],d.color[1],d.color[2],Ns);const V=void 0!==d.range?d.range:0;switch(d.type){case"directional":f=new ut(F),f.target.position.set(0,0,-1),f.add(f.target);break;case"point":f=new lt(F),f.distance=V;break;case"spot":f=new at(F),f.distance=V,d.spot=d.spot||{},d.spot.innerConeAngle=void 0!==d.spot.innerConeAngle?d.spot.innerConeAngle:0,d.spot.outerConeAngle=void 0!==d.spot.outerConeAngle?d.spot.outerConeAngle:Math.PI/4,f.angle=d.spot.outerConeAngle,f.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,f.target.position.set(0,0,-1),f.add(f.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return f.position.set(0,0,0),f.decay=2,en(f,d),void 0!==d.intensity&&(f.intensity=d.intensity),f.name=r.createUniqueName(d.name||"light_"+e),u=Promise.resolve(f),r.cache.add(l,u),u}getDependency(e,r){if("light"===e)return this._loadLight(r)}createNodeAttachment(e){const r=this,l=this.parser,u=l.json.nodes[e],h=(u.extensions&&u.extensions[this.name]||{}).light;return void 0===h?null:this._loadLight(h).then(function(e){return l._getNodeRef(r.cache,h,e)})}}class bh{constructor(){this.name=Us.KHR_MATERIALS_UNLIT}getMaterialType(){return kt}extendParams(e,r,l){const u=[];e.color=new ot(1,1,1),e.opacity=1;const h=r.pbrMetallicRoughness;if(h){if(Array.isArray(h.baseColorFactor)){const r=h.baseColorFactor;e.color.setRGB(r[0],r[1],r[2],Ns),e.opacity=r[3]}void 0!==h.baseColorTexture&&u.push(l.assignTexture(e,"map",h.baseColorTexture,Os))}return Promise.all(u)}}class Eh{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,r){const l=this.parser.json.materials[e];if(!l.extensions||!l.extensions[this.name])return Promise.resolve();const u=l.extensions[this.name].emissiveStrength;return void 0!==u&&(r.emissiveIntensity=u),Promise.resolve()}}class Mh{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];if(void 0!==d.clearcoatFactor&&(r.clearcoat=d.clearcoatFactor),void 0!==d.clearcoatTexture&&h.push(l.assignTexture(r,"clearcoatMap",d.clearcoatTexture)),void 0!==d.clearcoatRoughnessFactor&&(r.clearcoatRoughness=d.clearcoatRoughnessFactor),void 0!==d.clearcoatRoughnessTexture&&h.push(l.assignTexture(r,"clearcoatRoughnessMap",d.clearcoatRoughnessTexture)),void 0!==d.clearcoatNormalTexture&&(h.push(l.assignTexture(r,"clearcoatNormalMap",d.clearcoatNormalTexture)),void 0!==d.clearcoatNormalTexture.scale)){const e=d.clearcoatNormalTexture.scale;r.clearcoatNormalScale=new Ze(e,e)}return Promise.all(h)}}class Sh{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser.json.materials[e];if(!l.extensions||!l.extensions[this.name])return Promise.resolve();const u=l.extensions[this.name];return r.dispersion=void 0!==u.dispersion?u.dispersion:0,Promise.resolve()}}class Ah{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];return void 0!==d.iridescenceFactor&&(r.iridescence=d.iridescenceFactor),void 0!==d.iridescenceTexture&&h.push(l.assignTexture(r,"iridescenceMap",d.iridescenceTexture)),void 0!==d.iridescenceIor&&(r.iridescenceIOR=d.iridescenceIor),void 0===r.iridescenceThicknessRange&&(r.iridescenceThicknessRange=[100,400]),void 0!==d.iridescenceThicknessMinimum&&(r.iridescenceThicknessRange[0]=d.iridescenceThicknessMinimum),void 0!==d.iridescenceThicknessMaximum&&(r.iridescenceThicknessRange[1]=d.iridescenceThicknessMaximum),void 0!==d.iridescenceThicknessTexture&&h.push(l.assignTexture(r,"iridescenceThicknessMap",d.iridescenceThicknessTexture)),Promise.all(h)}}class Ph{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[];r.sheenColor=new ot(0,0,0),r.sheenRoughness=0,r.sheen=1;const d=u.extensions[this.name];if(void 0!==d.sheenColorFactor){const e=d.sheenColorFactor;r.sheenColor.setRGB(e[0],e[1],e[2],Ns)}return void 0!==d.sheenRoughnessFactor&&(r.sheenRoughness=d.sheenRoughnessFactor),void 0!==d.sheenColorTexture&&h.push(l.assignTexture(r,"sheenColorMap",d.sheenColorTexture,Os)),void 0!==d.sheenRoughnessTexture&&h.push(l.assignTexture(r,"sheenRoughnessMap",d.sheenRoughnessTexture)),Promise.all(h)}}class Rh{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];return void 0!==d.transmissionFactor&&(r.transmission=d.transmissionFactor),void 0!==d.transmissionTexture&&h.push(l.assignTexture(r,"transmissionMap",d.transmissionTexture)),Promise.all(h)}}class Ch{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];r.thickness=void 0!==d.thicknessFactor?d.thicknessFactor:0,void 0!==d.thicknessTexture&&h.push(l.assignTexture(r,"thicknessMap",d.thicknessTexture)),r.attenuationDistance=d.attenuationDistance||1/0;const f=d.attenuationColor||[1,1,1];return r.attenuationColor=(new ot).setRGB(f[0],f[1],f[2],Ns),Promise.all(h)}}class Ih{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser.json.materials[e];if(!l.extensions||!l.extensions[this.name])return Promise.resolve();const u=l.extensions[this.name];return r.ior=void 0!==u.ior?u.ior:1.5,Promise.resolve()}}class Oh{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];r.specularIntensity=void 0!==d.specularFactor?d.specularFactor:1,void 0!==d.specularTexture&&h.push(l.assignTexture(r,"specularIntensityMap",d.specularTexture));const f=d.specularColorFactor||[1,1,1];return r.specularColor=(new ot).setRGB(f[0],f[1],f[2],Ns),void 0!==d.specularColorTexture&&h.push(l.assignTexture(r,"specularColorMap",d.specularColorTexture,Os)),Promise.all(h)}}class Dh{constructor(e){this.parser=e,this.name=Us.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];return r.bumpScale=void 0!==d.bumpFactor?d.bumpFactor:1,void 0!==d.bumpTexture&&h.push(l.assignTexture(r,"bumpMap",d.bumpTexture)),Promise.all(h)}}class Lh{constructor(e){this.parser=e,this.name=Us.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return r.extensions&&r.extensions[this.name]?it:null}extendMaterialParams(e,r){const l=this.parser,u=l.json.materials[e];if(!u.extensions||!u.extensions[this.name])return Promise.resolve();const h=[],d=u.extensions[this.name];return void 0!==d.anisotropyStrength&&(r.anisotropy=d.anisotropyStrength),void 0!==d.anisotropyRotation&&(r.anisotropyRotation=d.anisotropyRotation),void 0!==d.anisotropyTexture&&h.push(l.assignTexture(r,"anisotropyMap",d.anisotropyTexture)),Promise.all(h)}}class kh{constructor(e){this.parser=e,this.name=Us.KHR_TEXTURE_BASISU}loadTexture(e){const r=this.parser,l=r.json,u=l.textures[e];if(!u.extensions||!u.extensions[this.name])return null;const h=u.extensions[this.name],d=r.options.ktx2Loader;if(!d){if(l.extensionsRequired&&l.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return r.loadTextureImage(e,h.source,d)}}class Nh{constructor(e){this.parser=e,this.name=Us.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const r=this.name,l=this.parser,u=l.json,h=u.textures[e];if(!h.extensions||!h.extensions[r])return null;const d=h.extensions[r],f=u.images[d.source];let F=l.textureLoader;if(f.uri){const e=l.options.manager.getHandler(f.uri);null!==e&&(F=e)}return this.detectSupport().then(function(h){if(h)return l.loadTextureImage(e,d.source,F);if(u.extensionsRequired&&u.extensionsRequired.indexOf(r)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return l.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const r=new Image;r.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",r.onload=r.onerror=function(){e(1===r.height)}})),this.isSupported}}class Bh{constructor(e){this.parser=e,this.name=Us.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const r=this.name,l=this.parser,u=l.json,h=u.textures[e];if(!h.extensions||!h.extensions[r])return null;const d=h.extensions[r],f=u.images[d.source];let F=l.textureLoader;if(f.uri){const e=l.options.manager.getHandler(f.uri);null!==e&&(F=e)}return this.detectSupport().then(function(h){if(h)return l.loadTextureImage(e,d.source,F);if(u.extensionsRequired&&u.extensionsRequired.indexOf(r)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return l.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const r=new Image;r.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",r.onload=r.onerror=function(){e(1===r.height)}})),this.isSupported}}class Uh{constructor(e){this.name=Us.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const r=this.parser.json,l=r.bufferViews[e];if(l.extensions&&l.extensions[this.name]){const e=l.extensions[this.name],u=this.parser.getDependency("buffer",e.buffer),h=this.parser.options.meshoptDecoder;if(!h||!h.supported){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return u.then(function(r){const l=e.byteOffset||0,u=e.byteLength||0,d=e.count,f=e.byteStride,F=new Uint8Array(r,l,u);return h.decodeGltfBufferAsync?h.decodeGltfBufferAsync(d,f,F,e.mode,e.filter).then(function(e){return e.buffer}):h.ready.then(function(){const r=new ArrayBuffer(d*f);return h.decodeGltfBuffer(new Uint8Array(r),d,f,F,e.mode,e.filter),r})})}return null}}class Fh{constructor(e){this.name=Us.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const r=this.parser.json,l=r.nodes[e];if(!l.extensions||!l.extensions[this.name]||void 0===l.mesh)return null;const u=r.meshes[l.mesh];for(const e of u.primitives)if(e.mode!==Hs.TRIANGLES&&e.mode!==Hs.TRIANGLE_STRIP&&e.mode!==Hs.TRIANGLE_FAN&&void 0!==e.mode)return null;const h=l.extensions[this.name].attributes,d=[],f={};for(const e in h)d.push(this.parser.getDependency("accessor",h[e]).then(r=>(f[e]=r,f[e])));return d.length<1?null:(d.push(this.parser.createNodeMesh(e)),Promise.all(d).then(e=>{const r=e.pop(),l=r.isGroup?r.children:[r],u=e[0].count,h=[];for(const e of l){const r=new ht,l=new Ve,d=new We,F=new Ve(1,1,1),V=new pt(e.geometry,e.material,u);for(let e=0;e<u;e++)f.TRANSLATION&&l.fromBufferAttribute(f.TRANSLATION,e),f.ROTATION&&d.fromBufferAttribute(f.ROTATION,e),f.SCALE&&F.fromBufferAttribute(f.SCALE,e),V.setMatrixAt(e,r.compose(l,d,F));for(const r in f)if("_COLOR_0"===r){const e=f[r];V.instanceColor=new dt(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==r&&"ROTATION"!==r&&"SCALE"!==r&&e.geometry.setAttribute(r,f[r]);ft.prototype.copy.call(V,e),this.parser.assignFinalMaterial(V),h.push(V)}return r.isGroup?(r.clear(),r.add(...h),r):h[0]}))}}const js="glTF",zs=1313821514,Bs=5130562;class zh{constructor(e){this.name=Us.KHR_BINARY_GLTF,this.content=null,this.body=null;const r=new DataView(e,0,12);if(this.header={magic:ns(new Uint8Array(e.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0)},this.header.magic!==js)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const l=this.header.length-12,u=new DataView(e,12);let h=0;for(;h<l;){const r=u.getUint32(h,!0);h+=4;const l=u.getUint32(h,!0);if(h+=4,l===zs){const l=new Uint8Array(e,12+h,r);this.content=ns(l)}else if(l===Bs){const l=12+h;this.body=e.slice(l,l+r)}h+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Gh{constructor(e,r){if(!r)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Us.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=r,this.dracoLoader.preload()}decodePrimitive(e,r){const l=this.json,u=this.dracoLoader,h=e.extensions[this.name].bufferView,d=e.extensions[this.name].attributes,f={},F={},V={};for(const e in d){const r=Ws[e]||e.toLowerCase();f[r]=d[e]}for(const r in e.attributes){const u=Ws[r]||r.toLowerCase();if(void 0!==d[r]){const h=l.accessors[e.attributes[r]],d=Gs[h.componentType];V[u]=d.name,F[u]=!0===h.normalized}}return r.getDependency("bufferView",h).then(function(e){return new Promise(function(r,l){u.decodeDracoFile(e,function(e){for(const r in e.attributes){const l=e.attributes[r],u=F[r];void 0!==u&&(l.normalized=u)}r(e)},f,V,Ns,l)})})}}class Hh{constructor(){this.name=Us.KHR_TEXTURE_TRANSFORM}extendTexture(e,r){return(void 0===r.texCoord||r.texCoord===e.channel)&&void 0===r.offset&&void 0===r.rotation&&void 0===r.scale||(e=e.clone(),void 0!==r.texCoord&&(e.channel=r.texCoord),void 0!==r.offset&&e.offset.fromArray(r.offset),void 0!==r.rotation&&(e.rotation=r.rotation),void 0!==r.scale&&e.repeat.fromArray(r.scale),e.needsUpdate=!0),e}}class jh{constructor(){this.name=Us.KHR_MESH_QUANTIZATION}}class el extends sn{constructor(e,r,l,u){super(e,r,l,u)}copySampleValue_(e){const r=this.resultBuffer,l=this.sampleValues,u=this.valueSize,h=e*u*3+u;for(let e=0;e!==u;e++)r[e]=l[h+e];return r}interpolate_(e,r,l,u){const h=this.resultBuffer,d=this.sampleValues,f=this.valueSize,F=2*f,V=3*f,W=u-r,q=(l-r)/W,$=q*q,Q=$*q,J=e*V,re=J-V,oe=-2*Q+3*$,ae=Q-$,le=1-oe,ce=ae-$+q;for(let e=0;e!==f;e++){const r=d[re+e+f],l=d[re+e+F]*W,u=d[J+e+f],V=d[J+e]*W;h[e]=le*r+ce*l+oe*u+ae*V}return h}}const Fs=new We;class Yh extends el{interpolate_(e,r,l,u){const h=super.interpolate_(e,r,l,u);return Fs.fromArray(h).normalize().toArray(h),h}}const Hs={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Gs={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Vs={9728:At,9729:_t,9984:Tt,9985:wt,9986:xt,9987:bt},Ys={33071:Pt,33648:Et,10497:Mt},Xs={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ws={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...or>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},qs={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Zs={CUBICSPLINE:void 0,LINEAR:qt,STEP:Wt},$s="OPAQUE",Qs="MASK",Js="BLEND";function Xh(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new Lt({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Jt})),e.DefaultMaterial}function An(e,r,l){for(const u in l.extensions)void 0===e[u]&&(r.userData.gltfExtensions=r.userData.gltfExtensions||{},r.userData.gltfExtensions[u]=l.extensions[u])}function en(e,r){void 0!==r.extras&&"object"==typeof r.extras&&Object.assign(e.userData,r.extras)}function Zh(e,r){if(e.updateMorphTargets(),void 0!==r.weights)for(let l=0,u=r.weights.length;l<u;l++)e.morphTargetInfluences[l]=r.weights[l];if(r.extras&&Array.isArray(r.extras.targetNames)){const l=r.extras.targetNames;if(e.morphTargetInfluences.length===l.length){e.morphTargetDictionary={};for(let r=0,u=l.length;r<u;r++)e.morphTargetDictionary[l[r]]=r}}}function Kh(e){let r;const l=e.extensions&&e.extensions[Us.KHR_DRACO_MESH_COMPRESSION];if(r=l?"draco:"+l.bufferView+":"+l.indices+":"+Ii(l.attributes):e.indices+":"+Ii(e.attributes)+":"+e.mode,void 0!==e.targets)for(let l=0,u=e.targets.length;l<u;l++)r+=":"+Ii(e.targets[l]);return r}function Ii(e){let r="";const l=Object.keys(e).sort();for(let u=0,h=l.length;u<h;u++)r+=l[u]+":"+e[l[u]]+";";return r}function xo(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const ei=new ht;class Jh{constructor(e={},r={}){this.json=e,this.extensions={},this.plugins={},this.options=r,this.cache=new wh,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};typeof createImageBitmap>"u"?this.textureLoader=new mt(this.options.manager):this.textureLoader=new gt(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new tt(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,r){const l=this,u=this.json,h=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([l.getDependencies("scene"),l.getDependencies("animation"),l.getDependencies("camera")])}).then(function(r){const d={scene:r[0][u.scene||0],scenes:r[0],animations:r[1],cameras:r[2],asset:u.asset,parser:l,userData:{}};return An(h,d,u),en(d,u),Promise.all(l._invokeAll(function(e){return e.afterRoot&&e.afterRoot(d)})).then(function(){for(const e of d.scenes)e.updateMatrixWorld();e(d)})}).catch(r)}_markDefs(){const e=this.json.nodes||[],r=this.json.skins||[],l=this.json.meshes||[];for(let l=0,u=r.length;l<u;l++){const u=r[l].joints;for(let r=0,l=u.length;r<l;r++)e[u[r]].isBone=!0}for(let r=0,u=e.length;r<u;r++){const u=e[r];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(l[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}}_addNodeRef(e,r){void 0!==r&&(void 0===e.refs[r]&&(e.refs[r]=e.uses[r]=0),e.refs[r]++)}_getNodeRef(e,r,l){if(e.refs[r]<=1)return l;const u=l.clone(),i=(e,r)=>{const l=this.associations.get(e);null!=l&&this.associations.set(r,l);for(const[l,u]of e.children.entries())i(u,r.children[l])};return i(l,u),u.name+="_instance_"+e.uses[r]++,u}_invokeOne(e){const r=Object.values(this.plugins);r.push(this);for(let l=0;l<r.length;l++){const u=e(r[l]);if(u)return u}return null}_invokeAll(e){const r=Object.values(this.plugins);r.unshift(this);const l=[];for(let u=0;u<r.length;u++){const h=e(r[u]);h&&l.push(h)}return l}getDependency(e,r){const l=e+":"+r;let u=this.cache.get(l);if(!u){switch(e){case"scene":u=this.loadScene(r);break;case"node":u=this._invokeOne(function(e){return e.loadNode&&e.loadNode(r)});break;case"mesh":u=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(r)});break;case"accessor":u=this.loadAccessor(r);break;case"bufferView":u=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(r)});break;case"buffer":u=this.loadBuffer(r);break;case"material":u=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(r)});break;case"texture":u=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(r)});break;case"skin":u=this.loadSkin(r);break;case"animation":u=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(r)});break;case"camera":u=this.loadCamera(r);break;default:if(u=this._invokeOne(function(l){return l!=this&&l.getDependency&&l.getDependency(e,r)}),!u)throw new Error("Unknown type: "+e)}this.cache.add(l,u)}return u}getDependencies(e){let r=this.cache.get(e);if(!r){const l=this,u=this.json[e+("mesh"===e?"es":"s")]||[];r=Promise.all(u.map(function(r,u){return l.getDependency(e,u)})),this.cache.add(e,r)}return r}loadBuffer(e){const r=this.json.buffers[e],l=this.fileLoader;if(r.type&&"arraybuffer"!==r.type)throw new Error("THREE.GLTFLoader: "+r.type+" buffer type is not supported.");if(void 0===r.uri&&0===e)return Promise.resolve(this.extensions[Us.KHR_BINARY_GLTF].body);const u=this.options;return new Promise(function(e,h){l.load(st.resolveURL(r.uri,u.path),e,void 0,function(){h(new Error('THREE.GLTFLoader: Failed to load buffer "'+r.uri+'".'))})})}loadBufferView(e){const r=this.json.bufferViews[e];return this.getDependency("buffer",r.buffer).then(function(e){const l=r.byteLength||0,u=r.byteOffset||0;return e.slice(u,u+l)})}loadAccessor(e){const r=this,l=this.json,u=this.json.accessors[e];if(void 0===u.bufferView&&void 0===u.sparse){const e=Xs[u.type],r=Gs[u.componentType],l=!0===u.normalized,h=new r(u.count*e);return Promise.resolve(new rt(h,e,l))}const h=[];return void 0!==u.bufferView?h.push(this.getDependency("bufferView",u.bufferView)):h.push(null),void 0!==u.sparse&&(h.push(this.getDependency("bufferView",u.sparse.indices.bufferView)),h.push(this.getDependency("bufferView",u.sparse.values.bufferView))),Promise.all(h).then(function(e){const h=e[0],d=Xs[u.type],f=Gs[u.componentType],F=f.BYTES_PER_ELEMENT,V=F*d,W=u.byteOffset||0,q=void 0!==u.bufferView?l.bufferViews[u.bufferView].byteStride:void 0,$=!0===u.normalized;let Q,J;if(q&&q!==V){const e=Math.floor(W/q),l="InterleavedBuffer:"+u.bufferView+":"+u.componentType+":"+e+":"+u.count;let V=r.cache.get(l);V||(Q=new f(h,e*q,u.count*q/F),V=new vt(Q,q/F),r.cache.add(l,V)),J=new yt(V,d,W%q/F,$)}else Q=null===h?new f(u.count*d):new f(h,W,u.count*d),J=new rt(Q,d,$);if(void 0!==u.sparse){const r=Xs.SCALAR,l=Gs[u.sparse.indices.componentType],F=u.sparse.indices.byteOffset||0,V=u.sparse.values.byteOffset||0,W=new l(e[1],F,u.sparse.count*r),q=new f(e[2],V,u.sparse.count*d);null!==h&&(J=new rt(J.array.slice(),J.itemSize,J.normalized));for(let e=0,r=W.length;e<r;e++){const r=W[e];if(J.setX(r,q[e*d]),d>=2&&J.setY(r,q[e*d+1]),d>=3&&J.setZ(r,q[e*d+2]),d>=4&&J.setW(r,q[e*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return J})}loadTexture(e){const r=this.json,l=this.options,u=r.textures[e].source,h=r.images[u];let d=this.textureLoader;if(h.uri){const e=l.manager.getHandler(h.uri);null!==e&&(d=e)}return this.loadTextureImage(e,u,d)}loadTextureImage(e,r,l){const u=this,h=this.json,d=h.textures[e],f=h.images[r],F=(f.uri||f.bufferView)+":"+d.sampler;if(this.textureCache[F])return this.textureCache[F];const V=this.loadImageSource(r,l).then(function(r){r.flipY=!1,r.name=d.name||f.name||"",""===r.name&&"string"==typeof f.uri&&!1===f.uri.startsWith("data:image/")&&(r.name=f.uri);const l=(h.samplers||{})[d.sampler]||{};return r.magFilter=Vs[l.magFilter]||_t,r.minFilter=Vs[l.minFilter]||bt,r.wrapS=Ys[l.wrapS]||Mt,r.wrapT=Ys[l.wrapT]||Mt,u.associations.set(r,{textures:e}),r}).catch(function(){return null});return this.textureCache[F]=V,V}loadImageSource(e,r){const l=this.json,u=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());const h=l.images[e],d=self.URL||self.webkitURL;let f=h.uri||"",F=!1;if(void 0!==h.bufferView)f=this.getDependency("bufferView",h.bufferView).then(function(e){F=!0;const r=new Blob([e],{type:h.mimeType});return f=d.createObjectURL(r),f});else if(void 0===h.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const V=Promise.resolve(f).then(function(e){return new Promise(function(l,h){let d=l;!0===r.isImageBitmapLoader&&(d=function(e){const r=new Rt(e);r.needsUpdate=!0,l(r)}),r.load(st.resolveURL(e,u.path),d,void 0,h)})}).then(function(e){return!0===F&&d.revokeObjectURL(f),en(e,h),e.userData.mimeType=h.mimeType||function(e){return e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":"image/png"}(h.uri),e}).catch(function(e){throw e});return this.sourceCache[e]=V,V}assignTexture(e,r,l,u){const h=this;return this.getDependency("texture",l.index).then(function(d){if(!d)return null;if(void 0!==l.texCoord&&l.texCoord>0&&((d=d.clone()).channel=l.texCoord),h.extensions[Us.KHR_TEXTURE_TRANSFORM]){const e=void 0!==l.extensions?l.extensions[Us.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const r=h.associations.get(d);d=h.extensions[Us.KHR_TEXTURE_TRANSFORM].extendTexture(d,e),h.associations.set(d,r)}}return void 0!==u&&("number"==typeof u&&(u=3001===u?Os:Ns),"colorSpace"in d?d.colorSpace=u:d.encoding=u===Os?3001:3e3),e[r]=d,d})}assignFinalMaterial(e){const r=e.geometry;let l=e.material;const u=void 0===r.attributes.tangent,h=void 0!==r.attributes.color,d=void 0===r.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+l.uuid;let r=this.cache.get(e);r||(r=new It,St.prototype.copy.call(r,l),r.color.copy(l.color),r.map=l.map,r.sizeAttenuation=!1,this.cache.add(e,r)),l=r}else if(e.isLine){const e="LineBasicMaterial:"+l.uuid;let r=this.cache.get(e);r||(r=new Ct,St.prototype.copy.call(r,l),r.color.copy(l.color),r.map=l.map,this.cache.add(e,r)),l=r}if(u||h||d){let e="ClonedMaterial:"+l.uuid+":";u&&(e+="derivative-tangents:"),h&&(e+="vertex-colors:"),d&&(e+="flat-shading:");let r=this.cache.get(e);r||(r=l.clone(),h&&(r.vertexColors=!0),d&&(r.flatShading=!0),u&&(r.normalScale&&(r.normalScale.y*=-1),r.clearcoatNormalScale&&(r.clearcoatNormalScale.y*=-1)),this.cache.add(e,r),this.associations.set(r,this.associations.get(l))),l=r}e.material=l}getMaterialType(){return Lt}loadMaterial(e){const r=this,l=this.json,u=this.extensions,h=l.materials[e];let d;const f={},F=[];if((h.extensions||{})[Us.KHR_MATERIALS_UNLIT]){const e=u[Us.KHR_MATERIALS_UNLIT];d=e.getMaterialType(),F.push(e.extendParams(f,h,r))}else{const l=h.pbrMetallicRoughness||{};if(f.color=new ot(1,1,1),f.opacity=1,Array.isArray(l.baseColorFactor)){const e=l.baseColorFactor;f.color.setRGB(e[0],e[1],e[2],Ns),f.opacity=e[3]}void 0!==l.baseColorTexture&&F.push(r.assignTexture(f,"map",l.baseColorTexture,Os)),f.metalness=void 0!==l.metallicFactor?l.metallicFactor:1,f.roughness=void 0!==l.roughnessFactor?l.roughnessFactor:1,void 0!==l.metallicRoughnessTexture&&(F.push(r.assignTexture(f,"metalnessMap",l.metallicRoughnessTexture)),F.push(r.assignTexture(f,"roughnessMap",l.metallicRoughnessTexture))),d=this._invokeOne(function(r){return r.getMaterialType&&r.getMaterialType(e)}),F.push(Promise.all(this._invokeAll(function(r){return r.extendMaterialParams&&r.extendMaterialParams(e,f)})))}!0===h.doubleSided&&(f.side=Dt);const V=h.alphaMode||$s;if(V===Js?(f.transparent=!0,f.depthWrite=!1):(f.transparent=!1,V===Qs&&(f.alphaTest=void 0!==h.alphaCutoff?h.alphaCutoff:.5)),void 0!==h.normalTexture&&d!==kt&&(F.push(r.assignTexture(f,"normalMap",h.normalTexture)),f.normalScale=new Ze(1,1),void 0!==h.normalTexture.scale)){const e=h.normalTexture.scale;f.normalScale.set(e,e)}if(void 0!==h.occlusionTexture&&d!==kt&&(F.push(r.assignTexture(f,"aoMap",h.occlusionTexture)),void 0!==h.occlusionTexture.strength&&(f.aoMapIntensity=h.occlusionTexture.strength)),void 0!==h.emissiveFactor&&d!==kt){const e=h.emissiveFactor;f.emissive=(new ot).setRGB(e[0],e[1],e[2],Ns)}return void 0!==h.emissiveTexture&&d!==kt&&F.push(r.assignTexture(f,"emissiveMap",h.emissiveTexture,Os)),Promise.all(F).then(function(){const l=new d(f);return h.name&&(l.name=h.name),en(l,h),r.associations.set(l,{materials:e}),h.extensions&&An(u,l,h),l})}createUniqueName(e){const r=Ot.sanitizeNodeName(e||"");return r in this.nodeNamesUsed?r+"_"+ ++this.nodeNamesUsed[r]:(this.nodeNamesUsed[r]=0,r)}loadGeometries(e){const r=this,l=this.extensions,u=this.primitiveCache;function i(e){return l[Us.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then(function(l){return mr(l,e,r)})}const h=[];for(let l=0,d=e.length;l<d;l++){const d=e[l],f=Kh(d),F=u[f];if(F)h.push(F.promise);else{let e;e=d.extensions&&d.extensions[Us.KHR_DRACO_MESH_COMPRESSION]?i(d):mr(new nt,d,r),u[f]={primitive:d,promise:e},h.push(e)}}return Promise.all(h)}loadMesh(e){const r=this,l=this.json,u=this.extensions,h=l.meshes[e],d=h.primitives,f=[];for(let e=0,r=d.length;e<r;e++){const r=void 0===d[e].material?Xh(this.cache):this.getDependency("material",d[e].material);f.push(r)}return f.push(r.loadGeometries(d)),Promise.all(f).then(function(l){const f=l.slice(0,l.length-1),F=l[l.length-1],V=[];for(let l=0,W=F.length;l<W;l++){const W=F[l],q=d[l];let $;const Q=f[l];if(q.mode===Hs.TRIANGLES||q.mode===Hs.TRIANGLE_STRIP||q.mode===Hs.TRIANGLE_FAN||void 0===q.mode)$=!0===h.isSkinnedMesh?new Ut(W,Q):new jt(W,Q),!0===$.isSkinnedMesh&&$.normalizeSkinWeights(),q.mode===Hs.TRIANGLE_STRIP?$.geometry=er($.geometry,rn):q.mode===Hs.TRIANGLE_FAN&&($.geometry=er($.geometry,nn));else if(q.mode===Hs.LINES)$=new zt(W,Q);else if(q.mode===Hs.LINE_STRIP)$=new Bt(W,Q);else if(q.mode===Hs.LINE_LOOP)$=new Ft(W,Q);else{if(q.mode!==Hs.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+q.mode);$=new Ht(W,Q)}Object.keys($.geometry.morphAttributes).length>0&&Zh($,h),$.name=r.createUniqueName(h.name||"mesh_"+e),en($,h),q.extensions&&An(u,$,q),r.assignFinalMaterial($),V.push($)}for(let l=0,u=V.length;l<u;l++)r.associations.set(V[l],{meshes:e,primitives:l});if(1===V.length)return h.extensions&&An(u,V[0],h),V[0];const W=new Gt;h.extensions&&An(u,W,h),r.associations.set(W,{meshes:e});for(let e=0,r=V.length;e<r;e++)W.add(V[e]);return W})}loadCamera(e){let r;const l=this.json.cameras[e],u=l[l.type];if(u)return"perspective"===l.type?r=new $e(Vt.radToDeg(u.yfov),u.aspectRatio||1,u.znear||1,u.zfar||2e6):"orthographic"===l.type&&(r=new qe(-u.xmag,u.xmag,u.ymag,-u.ymag,u.znear,u.zfar)),l.name&&(r.name=this.createUniqueName(l.name)),en(r,l),Promise.resolve(r)}loadSkin(e){const r=this.json.skins[e],l=[];for(let e=0,u=r.joints.length;e<u;e++)l.push(this._loadNodeShallow(r.joints[e]));return void 0!==r.inverseBindMatrices?l.push(this.getDependency("accessor",r.inverseBindMatrices)):l.push(null),Promise.all(l).then(function(e){const r=e.pop(),l=e,u=[],h=[];for(let e=0,d=l.length;e<d;e++){const d=l[e];if(d){u.push(d);const l=new ht;null!==r&&l.fromArray(r.array,16*e),h.push(l)}}return new Yt(u,h)})}loadAnimation(e){const r=this.json,l=this,u=r.animations[e],h=u.name?u.name:"animation_"+e,d=[],f=[],F=[],V=[],W=[];for(let e=0,r=u.channels.length;e<r;e++){const r=u.channels[e],l=u.samplers[r.sampler],h=r.target,q=h.node,$=void 0!==u.parameters?u.parameters[l.input]:l.input,Q=void 0!==u.parameters?u.parameters[l.output]:l.output;void 0!==h.node&&(d.push(this.getDependency("node",q)),f.push(this.getDependency("accessor",$)),F.push(this.getDependency("accessor",Q)),V.push(l),W.push(h))}return Promise.all([Promise.all(d),Promise.all(f),Promise.all(F),Promise.all(V),Promise.all(W)]).then(function(e){const r=e[0],u=e[1],d=e[2],f=e[3],F=e[4],V=[];for(let e=0,h=r.length;e<h;e++){const h=r[e],W=u[e],q=d[e],$=f[e],Q=F[e];if(void 0===h)continue;h.updateMatrix&&h.updateMatrix();const J=l._createAnimationTracks(h,W,q,$,Q);if(J)for(let e=0;e<J.length;e++)V.push(J[e])}return new Xt(h,void 0,V)})}createNodeMesh(e){const r=this.json,l=this,u=r.nodes[e];return void 0===u.mesh?null:l.getDependency("mesh",u.mesh).then(function(e){const r=l._getNodeRef(l.meshCache,u.mesh,e);return void 0!==u.weights&&r.traverse(function(e){if(e.isMesh)for(let r=0,l=u.weights.length;r<l;r++)e.morphTargetInfluences[r]=u.weights[r]}),r})}loadNode(e){const r=this,l=this.json.nodes[e],u=r._loadNodeShallow(e),h=[],d=l.children||[];for(let e=0,l=d.length;e<l;e++)h.push(r.getDependency("node",d[e]));const f=void 0===l.skin?Promise.resolve(null):r.getDependency("skin",l.skin);return Promise.all([u,Promise.all(h),f]).then(function(e){const r=e[0],l=e[1],u=e[2];null!==u&&r.traverse(function(e){e.isSkinnedMesh&&e.bind(u,ei)});for(let e=0,u=l.length;e<u;e++)r.add(l[e]);return r})}_loadNodeShallow(e){const r=this.json,l=this.extensions,u=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const h=r.nodes[e],d=h.name?u.createUniqueName(h.name):"",f=[],F=u._invokeOne(function(r){return r.createNodeMesh&&r.createNodeMesh(e)});return F&&f.push(F),void 0!==h.camera&&f.push(u.getDependency("camera",h.camera).then(function(e){return u._getNodeRef(u.cameraCache,h.camera,e)})),u._invokeAll(function(r){return r.createNodeAttachment&&r.createNodeAttachment(e)}).forEach(function(e){f.push(e)}),this.nodeCache[e]=Promise.all(f).then(function(r){let f;if(f=!0===h.isBone?new Kt:r.length>1?new Gt:1===r.length?r[0]:new ft,f!==r[0])for(let e=0,l=r.length;e<l;e++)f.add(r[e]);if(h.name&&(f.userData.name=h.name,f.name=d),en(f,h),h.extensions&&An(l,f,h),void 0!==h.matrix){const e=new ht;e.fromArray(h.matrix),f.applyMatrix4(e)}else void 0!==h.translation&&f.position.fromArray(h.translation),void 0!==h.rotation&&f.quaternion.fromArray(h.rotation),void 0!==h.scale&&f.scale.fromArray(h.scale);return u.associations.has(f)||u.associations.set(f,{}),u.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const r=this.extensions,l=this.json.scenes[e],u=this,h=new Gt;l.name&&(h.name=u.createUniqueName(l.name)),en(h,l),l.extensions&&An(r,h,l);const d=l.nodes||[],f=[];for(let e=0,r=d.length;e<r;e++)f.push(u.getDependency("node",d[e]));return Promise.all(f).then(function(e){for(let r=0,l=e.length;r<l;r++)h.add(e[r]);return u.associations=(e=>{const r=new Map;for(const[e,l]of u.associations)(e instanceof St||e instanceof Rt)&&r.set(e,l);return e.traverse(e=>{const l=u.associations.get(e);null!=l&&r.set(e,l)}),r})(h),h})}_createAnimationTracks(e,r,l,u,h){const d=[],f=e.name?e.name:e.uuid,F=[];let V;switch(qs[h.path]===qs.weights?e.traverse(function(e){e.morphTargetInfluences&&F.push(e.name?e.name:e.uuid)}):F.push(f),qs[h.path]){case qs.weights:V=$t;break;case qs.rotation:V=Qt;break;case qs.position:case qs.scale:V=Zt;break;default:if(1===l.itemSize)V=$t;else V=Zt}const W=void 0!==u.interpolation?Zs[u.interpolation]:qt,q=this._getArrayFromAccessor(l);for(let e=0,l=F.length;e<l;e++){const l=new V(F[e]+"."+qs[h.path],r.array,q,W);"CUBICSPLINE"===u.interpolation&&this._createCubicSplineTrackInterpolant(l),d.push(l)}return d}_getArrayFromAccessor(e){let r=e.array;if(e.normalized){const e=xo(r.constructor),l=new Float32Array(r.length);for(let u=0,h=r.length;u<h;u++)l[u]=r[u]*e;r=l}return r}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof Qt?Yh:el)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function mr(e,r,l){const u=r.attributes,h=[];function i(r,u){return l.getDependency("accessor",r).then(function(r){e.setAttribute(u,r)})}for(const r in u){const l=Ws[r]||r.toLowerCase();l in e.attributes||h.push(i(u[r],l))}if(void 0!==r.indices&&!e.index){const u=l.getDependency("accessor",r.indices).then(function(r){e.setIndex(r)});h.push(u)}return en(e,r),function(e,r,l){const u=r.attributes,h=new on;if(void 0===u.POSITION)return;{const e=l.json.accessors[u.POSITION],r=e.min,d=e.max;if(void 0===r||void 0===d)return;if(h.set(new Ve(r[0],r[1],r[2]),new Ve(d[0],d[1],d[2])),e.normalized){const r=xo(Gs[e.componentType]);h.min.multiplyScalar(r),h.max.multiplyScalar(r)}}const d=r.targets;if(void 0!==d){const e=new Ve,r=new Ve;for(let u=0,h=d.length;u<h;u++){const h=d[u];if(void 0!==h.POSITION){const u=l.json.accessors[h.POSITION],d=u.min,f=u.max;if(void 0!==d&&void 0!==f){if(r.setX(Math.max(Math.abs(d[0]),Math.abs(f[0]))),r.setY(Math.max(Math.abs(d[1]),Math.abs(f[1]))),r.setZ(Math.max(Math.abs(d[2]),Math.abs(f[2]))),u.normalized){const e=xo(Gs[u.componentType]);r.multiplyScalar(e)}e.max(r)}}}h.expandByVector(e)}e.boundingBox=h;const f=new an;h.getCenter(f.center),f.radius=h.min.distanceTo(h.max)/2,e.boundingSphere=f}(e,r,l),Promise.all(h).then(function(){return void 0!==r.targets?function(e,r,l){let u=!1,h=!1,d=!1;for(let e=0,l=r.length;e<l;e++){const l=r[e];if(void 0!==l.POSITION&&(u=!0),void 0!==l.NORMAL&&(h=!0),void 0!==l.COLOR_0&&(d=!0),u&&h&&d)break}if(!u&&!h&&!d)return Promise.resolve(e);const f=[],F=[],V=[];for(let W=0,q=r.length;W<q;W++){const q=r[W];if(u){const r=void 0!==q.POSITION?l.getDependency("accessor",q.POSITION):e.attributes.position;f.push(r)}if(h){const r=void 0!==q.NORMAL?l.getDependency("accessor",q.NORMAL):e.attributes.normal;F.push(r)}if(d){const r=void 0!==q.COLOR_0?l.getDependency("accessor",q.COLOR_0):e.attributes.color;V.push(r)}}return Promise.all([Promise.all(f),Promise.all(F),Promise.all(V)]).then(function(r){const l=r[0],f=r[1],F=r[2];return u&&(e.morphAttributes.position=l),h&&(e.morphAttributes.normal=f),d&&(e.morphAttributes.color=F),e.morphTargetsRelative=!0,e})}(e,r.targets,l):e})}new Ve,new mn,new Ve;var ti=Object.defineProperty,zo=(e,r,l)=>(((e,r,l)=>{r in e?ti(e,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[r]=l})(e,"symbol"!=typeof r?r+"":r,l),l);class Go{constructor(e){zo(this,"data"),this.data=e}generateShapes(e,r=100,l){const u=[],h={letterSpacing:0,lineHeight:1,...l},d=function(e,r,l,u){const h=Array.from(e),d=r/l.resolution,f=(l.boundingBox.yMax-l.boundingBox.yMin+l.underlineThickness)*d,F=[];let V=0,W=0;for(let e=0;e<h.length;e++){const r=h[e];if("\n"===r)V=0,W-=f*u.lineHeight;else{const e=Pf(r,d,V,W,l);e&&(V+=e.offsetX+u.letterSpacing,F.push(e.path))}}return F}(e,r,this.data,h);for(let e=0,r=d.length;e<r;e++)Array.prototype.push.apply(u,d[e].toShapes(!1));return u}}function Pf(e,r,l,u,h){const d=h.glyphs[e]||h.glyphs["?"];if(!d)return;const f=new Un;let F,V,W,q,$,Q,J,re;if(d.o){const e=d._cachedOutline||(d._cachedOutline=d.o.split(" "));for(let h=0,d=e.length;h<d;)switch(e[h++]){case"m":F=parseInt(e[h++])*r+l,V=parseInt(e[h++])*r+u,f.moveTo(F,V);break;case"l":F=parseInt(e[h++])*r+l,V=parseInt(e[h++])*r+u,f.lineTo(F,V);break;case"q":W=parseInt(e[h++])*r+l,q=parseInt(e[h++])*r+u,$=parseInt(e[h++])*r+l,Q=parseInt(e[h++])*r+u,f.quadraticCurveTo($,Q,W,q);break;case"b":W=parseInt(e[h++])*r+l,q=parseInt(e[h++])*r+u,$=parseInt(e[h++])*r+l,Q=parseInt(e[h++])*r+u,J=parseInt(e[h++])*r+l,re=parseInt(e[h++])*r+u,f.bezierCurveTo($,Q,J,re,W,q)}}return{offsetX:d.ha*r,path:f}}zo(Go,"isFont"),zo(Go,"type");const ni=new WeakMap;class Cf extends et{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,r,l,u){const h=new tt(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,e=>{const l={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,l).then(r).catch(u)},l,u)}decodeDracoFile(e,r,l,u){const h={attributeIDs:l||this.defaultAttributeIDs,attributeTypes:u||this.defaultAttributeTypes,useUniqueIDs:!!l};this.decodeGeometry(e,h).then(r)}decodeGeometry(e,r){for(const e in r.attributeTypes){const l=r.attributeTypes[e];void 0!==l.BYTES_PER_ELEMENT&&(r.attributeTypes[e]=l.name)}const l=JSON.stringify(r);if(ni.has(e)){const r=ni.get(e);if(r.key===l)return r.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let u;const h=this.workerNextTaskID++,d=e.byteLength,f=this._getWorker(h,d).then(l=>(u=l,new Promise((l,d)=>{u._callbacks[h]={resolve:l,reject:d},u.postMessage({type:"decode",id:h,taskConfig:r,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return f.catch(()=>!0).then(()=>{u&&h&&this._releaseTask(u,h)}),ni.set(e,{key:l,promise:f}),f}_createGeometry(e){const r=new nt;e.index&&r.setIndex(new rt(e.index.array,1));for(let l=0;l<e.attributes.length;l++){const u=e.attributes[l],h=u.name,d=u.array,f=u.itemSize;r.setAttribute(h,new rt(d,f))}return r}_loadLibrary(e,r){const l=new tt(this.manager);return l.setPath(this.decoderPath),l.setResponseType(r),l.setWithCredentials(this.withCredentials),new Promise((r,u)=>{l.load(e,r,void 0,u)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,r=[];return e?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then(r=>{const l=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const u=If.toString(),h=["/* draco decoder */",l,"","/* worker */",u.substring(u.indexOf("{")+1,u.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([h]))}),this.decoderPending}_getWorker(e,r){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(r){const l=r.data;switch(l.type){case"decode":e._callbacks[l.id].resolve(l);break;case"error":e._callbacks[l.id].reject(l)}},this.workerPool.push(e)}else this.workerPool.sort(function(e,r){return e._taskLoad>r._taskLoad?-1:1});const l=this.workerPool[this.workerPool.length-1];return l._taskCosts[e]=r,l._taskLoad+=r,l})}_releaseTask(e,r){e._taskLoad-=e._taskCosts[r],delete e._callbacks[r],delete e._taskCosts[r]}debug(){}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function If(){let e,r;function s(e,r,l,u,h,d){const f=d.num_components(),F=l.num_points()*f,V=F*h.BYTES_PER_ELEMENT,W=function(e,r){switch(r){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,h),q=e._malloc(V);r.GetAttributeDataArrayForAllPoints(l,d,W,V,q);const $=new h(e.HEAPF32.buffer,q,F).slice();return e._free(q),{name:u,array:$,itemSize:f}}onmessage=function(l){const u=l.data;switch(u.type){case"init":e=u.decoderConfig,r=new Promise(function(r){e.onModuleLoaded=function(e){r({draco:e})},DracoDecoderModule(e)});break;case"decode":const l=u.buffer,h=u.taskConfig;r.then(e=>{const r=e.draco,d=new r.Decoder,f=new r.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const e=function(e,r,l,u){const h=u.attributeIDs,d=u.attributeTypes;let f,F;const V=r.GetEncodedGeometryType(l);if(V===e.TRIANGULAR_MESH)f=new e.Mesh,F=r.DecodeBufferToMesh(l,f);else{if(V!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");f=new e.PointCloud,F=r.DecodeBufferToPointCloud(l,f)}if(!F.ok()||0===f.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+F.error_msg());const W={index:null,attributes:[]};for(const l in h){const F=self[d[l]];let V,q;if(u.useUniqueIDs)q=h[l],V=r.GetAttributeByUniqueId(f,q);else{if(q=r.GetAttributeId(f,e[h[l]]),-1===q)continue;V=r.GetAttribute(f,q)}W.attributes.push(s(e,r,f,l,F,V))}return V===e.TRIANGULAR_MESH&&(W.index=function(e,r,l){const u=3*l.num_faces(),h=4*u,d=e._malloc(h);r.GetTrianglesUInt32Array(l,h,d);const f=new Uint32Array(e.HEAPF32.buffer,d,u).slice();return e._free(d),{array:f,itemSize:1}}(e,r,f)),e.destroy(f),W}(r,d,f,h),l=e.attributes.map(e=>e.array.buffer);e.index&&l.push(e.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:e},l)}catch(e){self.postMessage({type:"error",id:u.id,error:e.message})}finally{r.destroy(f),r.destroy(d)}})}}}new on,new Ve,new vn,new Ve,new Ve,new vn,new vn,new vn,new Ve,new ht,new yn,new Ve,new on,new an,new vn,Vt.clamp,Vt.lerp,No({screenspace:!1,color:new ot("black"),opacity:1,thickness:.05,size:new Ze(1,1)},"#include <common>\n   #include <morphtarget_pars_vertex>\n   #include <skinning_pars_vertex>\n   uniform float thickness;\n   uniform bool screenspace;\n   uniform vec2 size;\n   void main() {\n     #if defined (USE_SKINNING)\n       #include <beginnormal_vertex>\n       #include <morphnormal_vertex>\n       #include <skinbase_vertex>\n       #include <skinnormal_vertex>\n       #include <defaultnormal_vertex>\n     #endif\n     #include <begin_vertex>\n     #include <morphtarget_vertex>\n     #include <skinning_vertex>\n     #include <project_vertex>\n     vec4 tNormal = vec4(normal, 0.0);\n     vec4 tPosition = vec4(transformed, 1.0);\n     #ifdef USE_INSTANCING\n       tNormal = instanceMatrix * tNormal;\n       tPosition = instanceMatrix * tPosition;\n     #endif\n     if (screenspace) {\n       vec3 newPosition = tPosition.xyz + tNormal.xyz * thickness;\n       gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0); \n     } else {\n       vec4 clipPosition = projectionMatrix * modelViewMatrix * tPosition;\n       vec4 clipNormal = projectionMatrix * modelViewMatrix * tNormal;\n       vec2 offset = normalize(clipNormal.xy) * thickness / size * clipPosition.w * 2.0;\n       clipPosition.xy += offset;\n       gl_Position = clipPosition;\n     }\n   }","uniform vec3 color;\n   uniform float opacity;\n   void main(){\n     gl_FragColor = vec4(color, opacity);\n     #include <tonemapping_fragment>\n     #include <colorspace_fragment>\n   }");var ri;xs.ReflectorShader,new Oe.Vector3,new Oe.Vector3,new Oe.Vector3,/Mac/.test(null===(ri=null==globalThis?void 0:globalThis.navigator)||void 0===ri?void 0:ri.platform);const si=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","mouse-buttons","args"],ii=$({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:ze.ROTATE,TWO:ze.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1},mouseButtons:{default:()=>({LEFT:je.ROTATE,MIDDLE:je.DOLLY,RIGHT:je.PAN})}},emits:["change","start","end"],setup(e,{expose:r,emit:l}){const u=e,h=l,{makeDefault:d,autoRotate:f,autoRotateSpeed:F,enableDamping:V,dampingFactor:W,enablePan:q,keyPanSpeed:$,maxAzimuthAngle:de,minAzimuthAngle:ge,maxPolarAngle:ve,minPolarAngle:ye,minDistance:be,maxDistance:xe,minZoom:Te,maxZoom:Ae,enableZoom:Me,zoomSpeed:Ee,enableRotate:Pe,touches:Ie,rotateSpeed:Se,target:Ce,mouseButtons:Le}=Q(u),{camera:De,renderer:ke,extend:Oe,controls:Ne,invalidate:Ue}=me(),je=J(null);Oe({OrbitControls:Qa}),re(je,e=>{Xe(je.value,"change",()=>{h("change",je.value),Ue()}),Xe(je.value,"start",()=>h("start",je.value)),Xe(je.value,"end",()=>h("end",je.value)),e&&d.value?Ne.value=e:Ne.value=null});const{onBeforeRender:ze}=Zr$1();return ze(({invalidate:e})=>{je.value&&(V.value||f.value)&&(je.value.update(),f.value&&e())}),le(()=>{je.value&&je.value.dispose()}),r({instance:je}),(e,r)=>(e.camera||ce(De))&&(e.domElement||ce(ke))?(ue(),oe("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:je,target:ce(Ce),"auto-rotate":ce(f),"auto-rotate-speed":ce(F),"enable-damping":ce(V),"damping-factor":ce(W),"enable-pan":ce(q),"key-pan-speed":ce($),keys:e.keys,"max-azimuth-angle":ce(de),"min-azimuth-angle":ce(ge),"max-polar-angle":ce(ve),"min-polar-angle":ce(ye),"min-distance":ce(be),"max-distance":ce(xe),"min-zoom":ce(Te),"max-zoom":ce(Ae),touches:ce(Ie),"enable-zoom":ce(Me),"zoom-speed":ce(Ee),"enable-rotate":ce(Pe),"rotate-speed":ce(Se),"mouse-buttons":ce(Le),args:[e.camera||ce(De),e.domElement||ce(ke).domElement]},null,8,si)):ae("",!0)}});const oi=class extends et{constructor(e){super(e),pe(this,"gltfLoader"),this.gltfLoader=new xh(e)}load(e,r,l,u){const h=Array.isArray(e)?e[0]:e;this.gltfLoader.load(h,r,l,u)}async loadAsync(e){const r=Array.isArray(e)?e[0]:e;return this.gltfLoader.loadAsync(r)}setDRACOLoader(e){return this.gltfLoader.setDRACOLoader(e)}};let ai=null;async function kd(e,r={draco:!1},l){const u=await Dn(oi,e,function(e){return r=>{e.draco&&(ai||(ai=new Cf),ai.setDecoderPath(e.decoderPath||"https://www.gstatic.com/draco/versioned/decoders/1.4.3/"),r.setDRACOLoader&&r.setDRACOLoader(ai))}}(r));return null==ai||ai.dispose(),ai=null,u}let li=0;function Ps(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ks(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ci,ui,hi,di,fi,mi,gi,vi,yi,bi,xi,wi,Ti,_i,Ai,Mi={exports:{}};function vl(){return hi||(hi=1,ui=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]),ui}function yl(){return gi||(gi=1,mi=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]),mi}function Wd(){if(Ti)return wi;Ti=1,wi=function(de){var ge,ve,ye,be=0,xe=0,Te=d,Ae=[],Me=[],Ee=1,Pe=0,Ie=0,Se=!1,Ce=!1,Le="",De=l,ke=e;"300 es"===(de=de||{}).version&&(De=h,ke=u);var Oe={},Ne={};for(be=0;be<De.length;be++)Oe[De[be]]=!0;for(be=0;be<ke.length;be++)Ne[ke[be]]=!0;return function(e){return Me=[],null!==e?function(e){be=0,e.toString&&(e=e.toString()),Le+=e.replace(/\r\n/g,"\n"),ye=Le.length;for(var r;ge=Le[be],be<ye;){switch(r=be,Te){case F:be=L();break;case V:be=P();break;case W:be=S();break;case q:be=X();break;case $:be=K();break;case ce:be=j();break;case Q:be=se();break;case f:be=ie();break;case ae:be=z();break;case d:be=O()}if(r!==be)if("\n"===Le[r])Pe=0,++Ee;else++Pe}return xe+=be,Le=Le.slice(be),Me}(e):(Ae.length&&I(Ae.join("")),Te=le,I("(eof)"),Me)};function I(e){e.length&&Me.push({type:ue[Te],data:e,position:Ie,line:Ee,column:Pe})}function O(){return Ae=Ae.length?[]:Ae,"/"===ve&&"*"===ge?(Ie=xe+be-1,Te=F,ve=ge,be+1):"/"===ve&&"/"===ge?(Ie=xe+be-1,Te=V,ve=ge,be+1):"#"===ge?(Te=W,Ie=xe+be,be):/\s/.test(ge)?(Te=ae,Ie=xe+be,be):(Se=/\d/.test(ge),Ce=/[^\w_]/.test(ge),Ie=xe+be,Te=Se?$:Ce?q:f,be)}function z(){return/[^\s]/g.test(ge)?(I(Ae.join("")),Te=d,be):(Ae.push(ge),ve=ge,be+1)}function S(){return"\r"!==ge&&"\n"!==ge||"\\"===ve?(Ae.push(ge),ve=ge,be+1):(I(Ae.join("")),Te=d,be)}function P(){return S()}function L(){return"/"===ge&&"*"===ve?(Ae.push(ge),I(Ae.join("")),Te=d,be+1):(Ae.push(ge),ve=ge,be+1)}function X(){if("."===ve&&/\d/.test(ge))return Te=Q,be;if("/"===ve&&"*"===ge)return Te=F,be;if("/"===ve&&"/"===ge)return Te=V,be;if("."===ge&&Ae.length){for(;H(Ae););return Te=Q,be}if(";"===ge||")"===ge||"("===ge){if(Ae.length)for(;H(Ae););return I(ge),Te=d,be+1}var e=2===Ae.length&&"="!==ge;if(/[\w_\d\s]/.test(ge)||e){for(;H(Ae););return Te=d,be}return Ae.push(ge),ve=ge,be+1}function H(e){for(var l,u,h=0;;){if(l=r.indexOf(e.slice(0,e.length+h).join("")),u=r[l],-1===l){if(h--+e.length>0)continue;u=e.slice(0,1).join("")}return I(u),Ie+=u.length,(Ae=Ae.slice(u.length)).length}}function j(){return/[^a-fA-F0-9]/.test(ge)?(I(Ae.join("")),Te=d,be):(Ae.push(ge),ve=ge,be+1)}function K(){return"."===ge||/[eE]/.test(ge)?(Ae.push(ge),Te=Q,ve=ge,be+1):"x"===ge&&1===Ae.length&&"0"===Ae[0]?(Te=ce,Ae.push(ge),ve=ge,be+1):/[^\d]/.test(ge)?(I(Ae.join("")),Te=d,be):(Ae.push(ge),ve=ge,be+1)}function se(){return"f"===ge&&(Ae.push(ge),ve=ge,be+=1),/[eE]/.test(ge)||("-"===ge||"+"===ge)&&/[eE]/.test(ve)?(Ae.push(ge),ve=ge,be+1):/[^\d]/.test(ge)?(I(Ae.join("")),Te=d,be):(Ae.push(ge),ve=ge,be+1)}function ie(){if(/[^\d\w_]/.test(ge)){var e=Ae.join("");return Te=Ne[e]?oe:Oe[e]?re:J,I(Ae.join("")),Te=d,be}return Ae.push(ge),ve=ge,be+1}};var e=vl(),r=(fi||(fi=1,di=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]),di),l=yl(),u=function(){if(yi)return vi;yi=1;var e=vl();return vi=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])}(),h=function(){if(xi)return bi;xi=1;var e=yl();return e=e.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)}),bi=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])}(),d=999,f=9999,F=0,V=1,W=2,q=3,$=4,Q=5,J=6,re=7,oe=8,ae=9,le=10,ce=11,ue=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];return wi}function _l(e){var r=function(e,r){if("object"!=typeof e||null===e)return e;var l=e[Symbol.toPrimitive];if(void 0!==l){var u=l.call(e,r);if("object"!=typeof u)return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof r?r:String(r)}function Ge(e,r,l){return(r=_l(r))in e?Object.defineProperty(e,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[r]=l,e}ci||(ci=1,Mi.exports=function t(e,r,l){function o(h,d){if(!r[h]){if(!e[h]){if(!d&&Ks)return Ks(h);if(u)return u(h,!0);throw new Error("Cannot find module '"+h+"'")}d=r[h]={exports:{}},e[h][0].call(d.exports,function(r){return o(e[h][1][r]||r)},d,d.exports,t,e,r,l)}return r[h].exports}for(var u=Ks,h=0;h<l.length;h++)o(l[h]);return o}({1:[function(e,r,l){(function(u,h,d,f,F,V,W,q,$){var Q=e("crypto");function g(e,r){var l;return void 0===(l="passthrough"!==(r=b(e,r)).algorithm?Q.createHash(r.algorithm):new R).write&&(l.write=l.update,l.end=l.update),M(r,l).dispatch(e),l.update||l.end(""),l.digest?l.digest("buffer"===r.encoding?void 0:r.encoding):(e=l.read(),"buffer"!==r.encoding?e.toString(r.encoding):e)}(l=r.exports=g).sha1=function(e){return g(e)},l.keys=function(e){return g(e,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},l.MD5=function(e){return g(e,{algorithm:"md5",encoding:"hex"})},l.keysMD5=function(e){return g(e,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var J=Q.getHashes?Q.getHashes().slice():["sha1","md5"],re=(J.push("passthrough"),["buffer","hex","binary","base64"]);function b(e,r){var l={};if(l.algorithm=(r=r||{}).algorithm||"sha1",l.encoding=r.encoding||"hex",l.excludeValues=!!r.excludeValues,l.algorithm=l.algorithm.toLowerCase(),l.encoding=l.encoding.toLowerCase(),l.ignoreUnknown=!0===r.ignoreUnknown,l.respectType=!1!==r.respectType,l.respectFunctionNames=!1!==r.respectFunctionNames,l.respectFunctionProperties=!1!==r.respectFunctionProperties,l.unorderedArrays=!0===r.unorderedArrays,l.unorderedSets=!1!==r.unorderedSets,l.unorderedObjects=!1!==r.unorderedObjects,l.replacer=r.replacer||void 0,l.excludeKeys=r.excludeKeys||void 0,void 0===e)throw new Error("Object argument required.");for(var u=0;u<J.length;++u)J[u].toLowerCase()===l.algorithm.toLowerCase()&&(l.algorithm=J[u]);if(-1===J.indexOf(l.algorithm))throw new Error('Algorithm "'+l.algorithm+'"  not supported. supported values: '+J.join(", "));if(-1===re.indexOf(l.encoding)&&"passthrough"!==l.algorithm)throw new Error('Encoding "'+l.encoding+'"  not supported. supported values: '+re.join(", "));return l}function _(e){if("function"==typeof e)return null!=/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(e))}function M(e,r,l){function T(e){return r.update?r.update(e,"utf8"):r.write(e,"utf8")}return l=l||[],{dispatch:function(r){return this["_"+(null===(r=e.replacer?e.replacer(r):r)?"null":typeof r)](r)},_object:function(r){var u,h=Object.prototype.toString.call(r),f=/\[object (.*)\]/i.exec(h);if(f=(f=f?f[1]:"unknown:["+h+"]").toLowerCase(),0<=(h=l.indexOf(r)))return this.dispatch("[CIRCULAR:"+h+"]");if(l.push(r),void 0!==d&&d.isBuffer&&d.isBuffer(r))return T("buffer:"),T(r);if("object"===f||"function"===f||"asyncfunction"===f)return h=Object.keys(r),e.unorderedObjects&&(h=h.sort()),!1===e.respectType||_(r)||h.splice(0,0,"prototype","__proto__","constructor"),e.excludeKeys&&(h=h.filter(function(r){return!e.excludeKeys(r)})),T("object:"+h.length+":"),u=this,h.forEach(function(l){u.dispatch(l),T(":"),e.excludeValues||u.dispatch(r[l]),T(",")});if(!this["_"+f]){if(e.ignoreUnknown)return T("["+f+"]");throw new Error('Unknown object type "'+f+'"')}this["_"+f](r)},_array:function(r,u){u=void 0!==u?u:!1!==e.unorderedArrays;var h=this;if(T("array:"+r.length+":"),!u||r.length<=1)return r.forEach(function(e){return h.dispatch(e)});var d=[];return u=r.map(function(r){var u=new R,h=l.slice();return M(e,u,h).dispatch(r),d=d.concat(h.slice(l.length)),u.read().toString()}),l=l.concat(d),u.sort(),this._array(u,!1)},_date:function(e){return T("date:"+e.toJSON())},_symbol:function(e){return T("symbol:"+e.toString())},_error:function(e){return T("error:"+e.toString())},_boolean:function(e){return T("bool:"+e.toString())},_string:function(e){T("string:"+e.length+":"),T(e.toString())},_function:function(r){T("fn:"),_(r)?this.dispatch("[native]"):this.dispatch(r.toString()),!1!==e.respectFunctionNames&&this.dispatch("function-name:"+String(r.name)),e.respectFunctionProperties&&this._object(r)},_number:function(e){return T("number:"+e.toString())},_xml:function(e){return T("xml:"+e.toString())},_null:function(){return T("Null")},_undefined:function(){return T("Undefined")},_regexp:function(e){return T("regex:"+e.toString())},_uint8array:function(e){return T("uint8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint8clampedarray:function(e){return T("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(e))},_int8array:function(e){return T("int8array:"),this.dispatch(Array.prototype.slice.call(e))},_uint16array:function(e){return T("uint16array:"),this.dispatch(Array.prototype.slice.call(e))},_int16array:function(e){return T("int16array:"),this.dispatch(Array.prototype.slice.call(e))},_uint32array:function(e){return T("uint32array:"),this.dispatch(Array.prototype.slice.call(e))},_int32array:function(e){return T("int32array:"),this.dispatch(Array.prototype.slice.call(e))},_float32array:function(e){return T("float32array:"),this.dispatch(Array.prototype.slice.call(e))},_float64array:function(e){return T("float64array:"),this.dispatch(Array.prototype.slice.call(e))},_arraybuffer:function(e){return T("arraybuffer:"),this.dispatch(new Uint8Array(e))},_url:function(e){return T("url:"+e.toString())},_map:function(r){return T("map:"),r=Array.from(r),this._array(r,!1!==e.unorderedSets)},_set:function(r){return T("set:"),r=Array.from(r),this._array(r,!1!==e.unorderedSets)},_file:function(e){return T("file:"),this.dispatch([e.name,e.size,e.type,e.lastModfied])},_blob:function(){if(e.ignoreUnknown)return T("[blob]");throw Error('Hashing Blob objects is currently not supported\n(see https://github.com/puleos/object-hash/issues/26)\nUse "options.replacer" or "options.ignoreUnknown"\n')},_domwindow:function(){return T("domwindow")},_bigint:function(e){return T("bigint:"+e.toString())},_process:function(){return T("process")},_timer:function(){return T("timer")},_pipe:function(){return T("pipe")},_tcp:function(){return T("tcp")},_udp:function(){return T("udp")},_tty:function(){return T("tty")},_statwatcher:function(){return T("statwatcher")},_securecontext:function(){return T("securecontext")},_connection:function(){return T("connection")},_zlib:function(){return T("zlib")},_context:function(){return T("context")},_nodescript:function(){return T("nodescript")},_httpparser:function(){return T("httpparser")},_dataview:function(){return T("dataview")},_signal:function(){return T("signal")},_fsevent:function(){return T("fsevent")},_tlswrap:function(){return T("tlswrap")}}}function R(){return{buf:"",write:function(e){this.buf+=e},end:function(e){this.buf+=e},read:function(){return this.buf}}}l.writeToStream=function(e,r,l){return void 0===l&&(l=r,r={}),M(r=b(e,r),l).dispatch(e)}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,r,l){(function(e,r,u,h,d,f,F,V,W){!function(e){var r=typeof Uint8Array<"u"?Uint8Array:Array,l=43,u=47,h=48,d=97,f=65,F=45,V=95;function E(e){return(e=e.charCodeAt(0))===l||e===F?62:e===u||e===V?63:e<h?-1:e<h+10?e-h+26+26:e<f+26?e-f:e<d+26?e-d+26:void 0}e.toByteArray=function(e){var l,u;if(0<e.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var h=e.length,d=(h="="===e.charAt(h-2)?2:"="===e.charAt(h-1)?1:0,new r(3*e.length/4-h)),f=0<h?e.length-4:e.length,F=0;function Y(e){d[F++]=e}for(l=0;l<f;l+=4,0)Y((16711680&(u=E(e.charAt(l))<<18|E(e.charAt(l+1))<<12|E(e.charAt(l+2))<<6|E(e.charAt(l+3))))>>16),Y((65280&u)>>8),Y(255&u);return 2==h?Y(255&(u=E(e.charAt(l))<<2|E(e.charAt(l+1))>>4)):1==h&&(Y((u=E(e.charAt(l))<<10|E(e.charAt(l+1))<<4|E(e.charAt(l+2))>>2)>>8&255),Y(255&u)),d},e.fromByteArray=function(e){var r,l,u,h,d=e.length%3,f="";function Y(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)}for(r=0,u=e.length-d;r<u;r+=3)f+=Y((h=l=(e[r]<<16)+(e[r+1]<<8)+e[r+2])>>18&63)+Y(h>>12&63)+Y(h>>6&63)+Y(63&h);switch(d){case 1:f=(f+=Y((l=e[e.length-1])>>2))+Y(l<<4&63)+"==";break;case 2:f=(f=(f+=Y((l=(e[e.length-2]<<8)+e[e.length-1])>>10))+Y(l>>4&63))+Y(l<<2&63)+"="}return f}}(void 0===l?this.base64js={}:l)}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,r,l){(function(r,u,h,d,f,F,V,W,q){var $=e("base64-js"),Q=e("ieee754");function h(e,r,l){if(!(this instanceof h))return new h(e,r,l);var u,d,f,F,V=typeof e;if("base64"===r&&"string"==V)for(e=(F=e).trim?F.trim():F.replace(/^\s+|\s+$/g,"");e.length%4!=0;)e+="=";if("number"==V)u=Z(e);else if("string"==V)u=h.byteLength(e,r);else{if("object"!=V)throw new Error("First argument needs to be a number, array or string.");u=Z(e.length)}if(h._useTypedArrays?d=h._augment(new Uint8Array(u)):((d=this).length=u,d._isBuffer=!0),h._useTypedArrays&&"number"==typeof e.byteLength)d._set(e);else if(ee(F=e)||h.isBuffer(F)||F&&"object"==typeof F&&"number"==typeof F.length)for(f=0;f<u;f++)h.isBuffer(e)?d[f]=e.readUInt8(f):d[f]=e[f];else if("string"==V)d.write(e,0,r);else if("number"==V&&!h._useTypedArrays&&!l)for(f=0;f<u;f++)d[f]=0;return d}function p(e,r,l,u){return h._charsWritten=we(function(e){for(var r=[],l=0;l<e.length;l++)r.push(255&e.charCodeAt(l));return r}(r),e,l,u)}function b(e,r,l,u){return h._charsWritten=we(function(e){for(var r,l,u=[],h=0;h<e.length;h++)r=(l=e.charCodeAt(h))>>8,l%=256,u.push(l),u.push(r);return u}(r),e,l,u)}function _(e,r,l){var u="";l=Math.min(e.length,l);for(var h=r;h<l;h++)u+=String.fromCharCode(e[h]);return u}function M(e,r,l,u){var h;if(u||(z("boolean"==typeof l,"missing or invalid endian"),z(null!=r,"missing offset"),z(r+1<e.length,"Trying to read beyond buffer length")),!((u=e.length)<=r))return l?(h=e[r],r+1<u&&(h|=e[r+1]<<8)):(h=e[r]<<8,r+1<u&&(h|=e[r+1])),h}function R(e,r,l,u){var h;if(u||(z("boolean"==typeof l,"missing or invalid endian"),z(null!=r,"missing offset"),z(r+3<e.length,"Trying to read beyond buffer length")),!((u=e.length)<=r))return l?(r+2<u&&(h=e[r+2]<<16),r+1<u&&(h|=e[r+1]<<8),h|=e[r],r+3<u&&(h+=e[r+3]<<24>>>0)):(r+1<u&&(h=e[r+1]<<16),r+2<u&&(h|=e[r+2]<<8),r+3<u&&(h|=e[r+3]),h+=e[r]<<24>>>0),h}function w(e,r,l,u){if(u||(z("boolean"==typeof l,"missing or invalid endian"),z(null!=r,"missing offset"),z(r+1<e.length,"Trying to read beyond buffer length")),!(e.length<=r))return 32768&(u=M(e,r,l,!0))?-1*(65535-u+1):u}function E(e,r,l,u){if(u||(z("boolean"==typeof l,"missing or invalid endian"),z(null!=r,"missing offset"),z(r+3<e.length,"Trying to read beyond buffer length")),!(e.length<=r))return 2147483648&(u=R(e,r,l,!0))?-1*(4294967295-u+1):u}function x(e,r,l,u){return u||(z("boolean"==typeof l,"missing or invalid endian"),z(r+3<e.length,"Trying to read beyond buffer length")),Q.read(e,r,l,23,4)}function T(e,r,l,u){return u||(z("boolean"==typeof l,"missing or invalid endian"),z(r+7<e.length,"Trying to read beyond buffer length")),Q.read(e,r,l,52,8)}function y(e,r,l,u,h){if(h||(z(null!=r,"missing value"),z("boolean"==typeof u,"missing or invalid endian"),z(null!=l,"missing offset"),z(l+1<e.length,"trying to write beyond buffer length"),B(r,65535)),!((h=e.length)<=l))for(var d=0,f=Math.min(h-l,2);d<f;d++)e[l+d]=(r&255<<8*(u?d:1-d))>>>8*(u?d:1-d)}function A(e,r,l,u,h){if(h||(z(null!=r,"missing value"),z("boolean"==typeof u,"missing or invalid endian"),z(null!=l,"missing offset"),z(l+3<e.length,"trying to write beyond buffer length"),B(r,4294967295)),!((h=e.length)<=l))for(var d=0,f=Math.min(h-l,4);d<f;d++)e[l+d]=r>>>8*(u?d:3-d)&255}function C(e,r,l,u,h){h||(z(null!=r,"missing value"),z("boolean"==typeof u,"missing or invalid endian"),z(null!=l,"missing offset"),z(l+1<e.length,"Trying to write beyond buffer length"),D(r,32767,-32768)),e.length<=l||y(e,0<=r?r:65535+r+1,l,u,h)}function N(e,r,l,u,h){h||(z(null!=r,"missing value"),z("boolean"==typeof u,"missing or invalid endian"),z(null!=l,"missing offset"),z(l+3<e.length,"Trying to write beyond buffer length"),D(r,2147483647,-2147483648)),e.length<=l||A(e,0<=r?r:4294967295+r+1,l,u,h)}function U(e,r,l,u,h){h||(z(null!=r,"missing value"),z("boolean"==typeof u,"missing or invalid endian"),z(null!=l,"missing offset"),z(l+3<e.length,"Trying to write beyond buffer length"),O(r,34028234663852886e22,-34028234663852886e22)),e.length<=l||Q.write(e,r,l,u,23,4)}function Y(e,r,l,u,h){h||(z(null!=r,"missing value"),z("boolean"==typeof u,"missing or invalid endian"),z(null!=l,"missing offset"),z(l+7<e.length,"Trying to write beyond buffer length"),O(r,17976931348623157e292,-17976931348623157e292)),e.length<=l||Q.write(e,r,l,u,52,8)}l.Buffer=h,l.SlowBuffer=h,l.INSPECT_MAX_BYTES=50,h.poolSize=8192,h._useTypedArrays=function(){try{var e=new ArrayBuffer(0),r=new Uint8Array(e);return r.foo=function(){return 42},42===r.foo()&&"function"==typeof r.subarray}catch{return!1}}(),h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.isBuffer=function(e){return!(null==e||!e._isBuffer)},h.byteLength=function(e,r){var l;switch(e+="",r||"utf8"){case"hex":l=e.length/2;break;case"utf8":case"utf-8":l=fe(e).length;break;case"ascii":case"binary":case"raw":l=e.length;break;case"base64":l=he(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":l=2*e.length;break;default:throw new Error("Unknown encoding")}return l},h.concat=function(e,r){if(z(ee(e),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===e.length)return new h(0);if(1===e.length)return e[0];if("number"!=typeof r)for(d=r=0;d<e.length;d++)r+=e[d].length;for(var l=new h(r),u=0,d=0;d<e.length;d++){var f=e[d];f.copy(l,u),u+=f.length}return l},h.prototype.write=function(e,r,l,u){isFinite(r)?isFinite(l)||(u=l,l=void 0):(W=u,u=r,r=l,l=W),r=Number(r)||0;var d,f,F,V,W=this.length-r;switch((!l||W<(l=Number(l)))&&(l=W),u=String(u||"utf8").toLowerCase()){case"hex":d=function(e,r,l,u){l=Number(l)||0;var d=e.length-l;(!u||d<(u=Number(u)))&&(u=d),z((d=r.length)%2==0,"Invalid hex string"),d/2<u&&(u=d/2);for(var f=0;f<u;f++){var F=parseInt(r.substr(2*f,2),16);z(!isNaN(F),"Invalid hex string"),e[l+f]=F}return h._charsWritten=2*f,f}(this,e,r,l);break;case"utf8":case"utf-8":f=this,F=r,V=l,d=h._charsWritten=we(fe(e),f,F,V);break;case"ascii":case"binary":d=p(this,e,r,l);break;case"base64":f=this,F=r,V=l,d=h._charsWritten=we(he(e),f,F,V);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":d=b(this,e,r,l);break;default:throw new Error("Unknown encoding")}return d},h.prototype.toString=function(e,r,l){var u,h,d,f,F=this;if(e=String(e||"utf8").toLowerCase(),r=Number(r)||0,(l=void 0!==l?Number(l):F.length)===r)return"";switch(e){case"hex":u=function(e,r,l){var u=e.length;(!r||r<0)&&(r=0),(!l||l<0||u<l)&&(l=u);for(var h="",d=r;d<l;d++)h+=te(e[d]);return h}(F,r,l);break;case"utf8":case"utf-8":u=function(e,r,l){var u="",h="";l=Math.min(e.length,l);for(var d=r;d<l;d++)e[d]<=127?(u+=I(h)+String.fromCharCode(e[d]),h=""):h+="%"+e[d].toString(16);return u+I(h)}(F,r,l);break;case"ascii":case"binary":u=_(F,r,l);break;case"base64":h=F,f=l,u=0===(d=r)&&f===h.length?$.fromByteArray(h):$.fromByteArray(h.slice(d,f));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":u=function(e,r,l){for(var u=e.slice(r,l),h="",d=0;d<u.length;d+=2)h+=String.fromCharCode(u[d]+256*u[d+1]);return h}(F,r,l);break;default:throw new Error("Unknown encoding")}return u},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},h.prototype.copy=function(e,r,l,u){if(r=r||0,(u=u||0===u?u:this.length)!==(l=l||0)&&0!==e.length&&0!==this.length){z(l<=u,"sourceEnd < sourceStart"),z(0<=r&&r<e.length,"targetStart out of bounds"),z(0<=l&&l<this.length,"sourceStart out of bounds"),z(0<=u&&u<=this.length,"sourceEnd out of bounds"),u>this.length&&(u=this.length);var d=(u=e.length-r<u-l?e.length-r+l:u)-l;if(d<100||!h._useTypedArrays)for(var f=0;f<d;f++)e[f+r]=this[f+l];else e._set(this.subarray(l,l+d),r)}},h.prototype.slice=function(e,r){var l=this.length;if(e=ne(e,l,0),r=ne(r,l,l),h._useTypedArrays)return h._augment(this.subarray(e,r));for(var u=r-e,d=new h(u,void 0,!0),f=0;f<u;f++)d[f]=this[f+e];return d},h.prototype.get=function(e){return this.readUInt8(e)},h.prototype.set=function(e,r){return this.writeUInt8(e,r)},h.prototype.readUInt8=function(e,r){if(r||(z(null!=e,"missing offset"),z(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return this[e]},h.prototype.readUInt16LE=function(e,r){return M(this,e,!0,r)},h.prototype.readUInt16BE=function(e,r){return M(this,e,!1,r)},h.prototype.readUInt32LE=function(e,r){return R(this,e,!0,r)},h.prototype.readUInt32BE=function(e,r){return R(this,e,!1,r)},h.prototype.readInt8=function(e,r){if(r||(z(null!=e,"missing offset"),z(e<this.length,"Trying to read beyond buffer length")),!(e>=this.length))return 128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,r){return w(this,e,!0,r)},h.prototype.readInt16BE=function(e,r){return w(this,e,!1,r)},h.prototype.readInt32LE=function(e,r){return E(this,e,!0,r)},h.prototype.readInt32BE=function(e,r){return E(this,e,!1,r)},h.prototype.readFloatLE=function(e,r){return x(this,e,!0,r)},h.prototype.readFloatBE=function(e,r){return x(this,e,!1,r)},h.prototype.readDoubleLE=function(e,r){return T(this,e,!0,r)},h.prototype.readDoubleBE=function(e,r){return T(this,e,!1,r)},h.prototype.writeUInt8=function(e,r,l){l||(z(null!=e,"missing value"),z(null!=r,"missing offset"),z(r<this.length,"trying to write beyond buffer length"),B(e,255)),r>=this.length||(this[r]=e)},h.prototype.writeUInt16LE=function(e,r,l){y(this,e,r,!0,l)},h.prototype.writeUInt16BE=function(e,r,l){y(this,e,r,!1,l)},h.prototype.writeUInt32LE=function(e,r,l){A(this,e,r,!0,l)},h.prototype.writeUInt32BE=function(e,r,l){A(this,e,r,!1,l)},h.prototype.writeInt8=function(e,r,l){l||(z(null!=e,"missing value"),z(null!=r,"missing offset"),z(r<this.length,"Trying to write beyond buffer length"),D(e,127,-128)),r>=this.length||(0<=e?this.writeUInt8(e,r,l):this.writeUInt8(255+e+1,r,l))},h.prototype.writeInt16LE=function(e,r,l){C(this,e,r,!0,l)},h.prototype.writeInt16BE=function(e,r,l){C(this,e,r,!1,l)},h.prototype.writeInt32LE=function(e,r,l){N(this,e,r,!0,l)},h.prototype.writeInt32BE=function(e,r,l){N(this,e,r,!1,l)},h.prototype.writeFloatLE=function(e,r,l){U(this,e,r,!0,l)},h.prototype.writeFloatBE=function(e,r,l){U(this,e,r,!1,l)},h.prototype.writeDoubleLE=function(e,r,l){Y(this,e,r,!0,l)},h.prototype.writeDoubleBE=function(e,r,l){Y(this,e,r,!1,l)},h.prototype.fill=function(e,r,l){if(r=r||0,l=l||this.length,z("number"==typeof(e="string"==typeof(e=e||0)?e.charCodeAt(0):e)&&!isNaN(e),"value is not a number"),z(r<=l,"end < start"),l!==r&&0!==this.length){z(0<=r&&r<this.length,"start out of bounds"),z(0<=l&&l<=this.length,"end out of bounds");for(var u=r;u<l;u++)this[u]=e}},h.prototype.inspect=function(){for(var e=[],r=this.length,u=0;u<r;u++)if(e[u]=te(this[u]),u===l.INSPECT_MAX_BYTES){e[u+1]="...";break}return"<Buffer "+e.join(" ")+">"},h.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(h._useTypedArrays)return new h(this).buffer;for(var e=new Uint8Array(this.length),r=0,l=e.length;r<l;r+=1)e[r]=this[r];return e.buffer};var J=h.prototype;function ne(e,r,l){return"number"!=typeof e?l:r<=(e=~~e)?r:0<=e||0<=(e+=r)?e:0}function Z(e){return(e=~~Math.ceil(+e))<0?0:e}function ee(e){return(Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)})(e)}function te(e){return e<16?"0"+e.toString(16):e.toString(16)}function fe(e){for(var r=[],l=0;l<e.length;l++){var u=e.charCodeAt(l);if(u<=127)r.push(e.charCodeAt(l));else for(var h=l,d=(55296<=u&&u<=57343&&l++,encodeURIComponent(e.slice(h,l+1)).substr(1).split("%")),f=0;f<d.length;f++)r.push(parseInt(d[f],16))}return r}function he(e){return $.toByteArray(e)}function we(e,r,l,u){for(var h=0;h<u&&!(h+l>=r.length||h>=e.length);h++)r[h+l]=e[h];return h}function I(e){try{return decodeURIComponent(e)}catch{return"�"}}function B(e,r){z("number"==typeof e,"cannot write a non-number as a number"),z(0<=e,"specified a negative value for writing an unsigned value"),z(e<=r,"value is larger than maximum value for type"),z(Math.floor(e)===e,"value has a fractional component")}function D(e,r,l){z("number"==typeof e,"cannot write a non-number as a number"),z(e<=r,"value larger than maximum allowed value"),z(l<=e,"value smaller than minimum allowed value"),z(Math.floor(e)===e,"value has a fractional component")}function O(e,r,l){z("number"==typeof e,"cannot write a non-number as a number"),z(e<=r,"value larger than maximum allowed value"),z(l<=e,"value smaller than minimum allowed value")}function z(e,r){if(!e)throw new Error(r||"Failed assertion")}h._augment=function(e){return e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=J.get,e.set=J.set,e.write=J.write,e.toString=J.toString,e.toLocaleString=J.toString,e.toJSON=J.toJSON,e.copy=J.copy,e.slice=J.slice,e.readUInt8=J.readUInt8,e.readUInt16LE=J.readUInt16LE,e.readUInt16BE=J.readUInt16BE,e.readUInt32LE=J.readUInt32LE,e.readUInt32BE=J.readUInt32BE,e.readInt8=J.readInt8,e.readInt16LE=J.readInt16LE,e.readInt16BE=J.readInt16BE,e.readInt32LE=J.readInt32LE,e.readInt32BE=J.readInt32BE,e.readFloatLE=J.readFloatLE,e.readFloatBE=J.readFloatBE,e.readDoubleLE=J.readDoubleLE,e.readDoubleBE=J.readDoubleBE,e.writeUInt8=J.writeUInt8,e.writeUInt16LE=J.writeUInt16LE,e.writeUInt16BE=J.writeUInt16BE,e.writeUInt32LE=J.writeUInt32LE,e.writeUInt32BE=J.writeUInt32BE,e.writeInt8=J.writeInt8,e.writeInt16LE=J.writeInt16LE,e.writeInt16BE=J.writeInt16BE,e.writeInt32LE=J.writeInt32LE,e.writeInt32BE=J.writeInt32BE,e.writeFloatLE=J.writeFloatLE,e.writeFloatBE=J.writeFloatBE,e.writeDoubleLE=J.writeDoubleLE,e.writeDoubleBE=J.writeDoubleBE,e.fill=J.fill,e.inspect=J.inspect,e.toArrayBuffer=J.toArrayBuffer,e}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,r,l){(function(l,u,h,d,f,F,V,W,q){h=e("buffer").Buffer;var $=4,Q=new h($);Q.fill(0),r.exports={hash:function(e,r,l,u){for(var d=r(function(e,r){e.length%$!=0&&(l=e.length+($-e.length%$),e=h.concat([e,Q],l));for(var l,u=[],d=r?e.readInt32BE:e.readInt32LE,f=0;f<e.length;f+=$)u.push(d.call(e,f));return u}(e=h.isBuffer(e)?e:new h(e),u),8*e.length),f=(r=u,new h(l)),F=r?f.writeInt32BE:f.writeInt32LE,V=0;V<d.length;V++)F.call(f,d[V],4*V,!0);return f}}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,r,l){(function(r,u,h,d,f,F,V,W,q){h=e("buffer").Buffer;var $=e("./sha"),Q=e("./sha256"),J=e("./rng"),re={sha1:$,sha256:Q,md5:e("./md5")},oe=64,ae=new h(oe);function R(e,r){var l=re[e=e||"sha1"],u=[];return l||w("algorithm:",e,"is not yet supported"),{update:function(e){return h.isBuffer(e)||(e=new h(e)),u.push(e),e.length,this},digest:function(e){var d=h.concat(u);return d=r?function(e,r,l){h.isBuffer(r)||(r=new h(r)),h.isBuffer(l)||(l=new h(l)),r.length>oe?r=e(r):r.length<oe&&(r=h.concat([r,ae],oe));for(var u=new h(oe),d=new h(oe),f=0;f<oe;f++)u[f]=54^r[f],d[f]=92^r[f];return l=e(h.concat([u,l])),e(h.concat([d,l]))}(l,r,d):l(d),u=null,e?d.toString(e):d}}}function w(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}ae.fill(0),l.createHash=function(e){return R(e)},l.createHmac=R,l.randomBytes=function(e,r){if(!r||!r.call)return new h(J(e));try{r.call(this,void 0,new h(J(e)))}catch(e){r(e)}};var le,ce=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],T=function(e){l[e]=function(){w("sorry,",e,"is not implemented yet")}};for(le in ce)T(ce[le])}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,r,l){(function(l,u,h,d,f,F,V,W,q){var $=e("./helpers");function g(e,r){e[r>>5]|=128<<r%32,e[14+(r+64>>>9<<4)]=r;for(var l=1732584193,u=-271733879,h=-1732584194,d=271733878,f=0;f<e.length;f+=16){var F=l,V=u,W=h,q=d;l=p(l,u,h,d,e[f+0],7,-680876936),d=p(d,l,u,h,e[f+1],12,-389564586),h=p(h,d,l,u,e[f+2],17,606105819),u=p(u,h,d,l,e[f+3],22,-1044525330),l=p(l,u,h,d,e[f+4],7,-176418897),d=p(d,l,u,h,e[f+5],12,1200080426),h=p(h,d,l,u,e[f+6],17,-1473231341),u=p(u,h,d,l,e[f+7],22,-45705983),l=p(l,u,h,d,e[f+8],7,1770035416),d=p(d,l,u,h,e[f+9],12,-1958414417),h=p(h,d,l,u,e[f+10],17,-42063),u=p(u,h,d,l,e[f+11],22,-1990404162),l=p(l,u,h,d,e[f+12],7,1804603682),d=p(d,l,u,h,e[f+13],12,-40341101),h=p(h,d,l,u,e[f+14],17,-1502002290),l=b(l,u=p(u,h,d,l,e[f+15],22,1236535329),h,d,e[f+1],5,-165796510),d=b(d,l,u,h,e[f+6],9,-1069501632),h=b(h,d,l,u,e[f+11],14,643717713),u=b(u,h,d,l,e[f+0],20,-373897302),l=b(l,u,h,d,e[f+5],5,-701558691),d=b(d,l,u,h,e[f+10],9,38016083),h=b(h,d,l,u,e[f+15],14,-660478335),u=b(u,h,d,l,e[f+4],20,-405537848),l=b(l,u,h,d,e[f+9],5,568446438),d=b(d,l,u,h,e[f+14],9,-1019803690),h=b(h,d,l,u,e[f+3],14,-187363961),u=b(u,h,d,l,e[f+8],20,1163531501),l=b(l,u,h,d,e[f+13],5,-1444681467),d=b(d,l,u,h,e[f+2],9,-51403784),h=b(h,d,l,u,e[f+7],14,1735328473),l=_(l,u=b(u,h,d,l,e[f+12],20,-1926607734),h,d,e[f+5],4,-378558),d=_(d,l,u,h,e[f+8],11,-2022574463),h=_(h,d,l,u,e[f+11],16,1839030562),u=_(u,h,d,l,e[f+14],23,-35309556),l=_(l,u,h,d,e[f+1],4,-1530992060),d=_(d,l,u,h,e[f+4],11,1272893353),h=_(h,d,l,u,e[f+7],16,-155497632),u=_(u,h,d,l,e[f+10],23,-1094730640),l=_(l,u,h,d,e[f+13],4,681279174),d=_(d,l,u,h,e[f+0],11,-358537222),h=_(h,d,l,u,e[f+3],16,-722521979),u=_(u,h,d,l,e[f+6],23,76029189),l=_(l,u,h,d,e[f+9],4,-640364487),d=_(d,l,u,h,e[f+12],11,-421815835),h=_(h,d,l,u,e[f+15],16,530742520),l=M(l,u=_(u,h,d,l,e[f+2],23,-995338651),h,d,e[f+0],6,-198630844),d=M(d,l,u,h,e[f+7],10,1126891415),h=M(h,d,l,u,e[f+14],15,-1416354905),u=M(u,h,d,l,e[f+5],21,-57434055),l=M(l,u,h,d,e[f+12],6,1700485571),d=M(d,l,u,h,e[f+3],10,-1894986606),h=M(h,d,l,u,e[f+10],15,-1051523),u=M(u,h,d,l,e[f+1],21,-2054922799),l=M(l,u,h,d,e[f+8],6,1873313359),d=M(d,l,u,h,e[f+15],10,-30611744),h=M(h,d,l,u,e[f+6],15,-1560198380),u=M(u,h,d,l,e[f+13],21,1309151649),l=M(l,u,h,d,e[f+4],6,-145523070),d=M(d,l,u,h,e[f+11],10,-1120210379),h=M(h,d,l,u,e[f+2],15,718787259),u=M(u,h,d,l,e[f+9],21,-343485551),l=R(l,F),u=R(u,V),h=R(h,W),d=R(d,q)}return Array(l,u,h,d)}function v(e,r,l,u,h,d){return R((r=R(R(r,e),R(u,d)))<<h|r>>>32-h,l)}function p(e,r,l,u,h,d,f){return v(r&l|~r&u,e,r,h,d,f)}function b(e,r,l,u,h,d,f){return v(r&u|l&~u,e,r,h,d,f)}function _(e,r,l,u,h,d,f){return v(r^l^u,e,r,h,d,f)}function M(e,r,l,u,h,d,f){return v(l^(r|~u),e,r,h,d,f)}function R(e,r){var l=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(l>>16)<<16|65535&l}r.exports=function(e){return $.hash(e,g,16)}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,r,l){(function(e,l,u,h,d,f,F,V,W){r.exports=function(e){for(var r,l=new Array(e),u=0;u<e;u++)!(3&u)&&(r=4294967296*Math.random()),l[u]=r>>>((3&u)<<3)&255;return l}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,r,l){(function(l,u,h,d,f,F,V,W,q){var $=e("./helpers");function g(e,r){e[r>>5]|=128<<24-r%32,e[15+(r+64>>9<<4)]=r;for(var l,u,h,d=Array(80),f=1732584193,F=-271733879,V=-1732584194,W=271733878,q=-1009589776,$=0;$<e.length;$+=16){for(var Q=f,J=F,re=V,oe=W,ae=q,le=0;le<80;le++){d[le]=le<16?e[$+le]:p(d[le-3]^d[le-8]^d[le-14]^d[le-16],1);var ce=v(v(p(f,5),(ce=F,u=V,h=W,(l=le)<20?ce&u|~ce&h:!(l<40)&&l<60?ce&u|ce&h|u&h:ce^u^h)),v(v(q,d[le]),(l=le)<20?1518500249:l<40?1859775393:l<60?-1894007588:-899497514));q=W,W=V,V=p(F,30),F=f,f=ce}f=v(f,Q),F=v(F,J),V=v(V,re),W=v(W,oe),q=v(q,ae)}return Array(f,F,V,W,q)}function v(e,r){var l=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(l>>16)<<16|65535&l}function p(e,r){return e<<r|e>>>32-r}r.exports=function(e){return $.hash(e,g,20,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,r,l){(function(l,u,h,d,f,F,V,W,q){function m(e,r){var l=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(l>>16)<<16|65535&l}function g(e,r){var l,u=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),h=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),d=new Array(64);e[r>>5]|=128<<24-r%32,e[15+(r+64>>9<<4)]=r;for(var f,F,V=0;V<e.length;V+=16){for(var W=h[0],q=h[1],$=h[2],Q=h[3],J=h[4],re=h[5],oe=h[6],ae=h[7],le=0;le<64;le++)d[le]=le<16?e[le+V]:m(m(m((F=d[le-2],p(F,17)^p(F,19)^b(F,10)),d[le-7]),(F=d[le-15],p(F,7)^p(F,18)^b(F,3))),d[le-16]),l=m(m(m(m(ae,p(F=J,6)^p(F,11)^p(F,25)),J&re^~J&oe),u[le]),d[le]),f=m(p(f=W,2)^p(f,13)^p(f,22),W&q^W&$^q&$),ae=oe,oe=re,re=J,J=m(Q,l),Q=$,$=q,q=W,W=m(l,f);h[0]=m(W,h[0]),h[1]=m(q,h[1]),h[2]=m($,h[2]),h[3]=m(Q,h[3]),h[4]=m(J,h[4]),h[5]=m(re,h[5]),h[6]=m(oe,h[6]),h[7]=m(ae,h[7])}return h}var $=e("./helpers"),p=function(e,r){return e>>>r|e<<32-r},b=function(e,r){return e>>>r};r.exports=function(e){return $.hash(e,g,32,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,r,l){(function(e,r,u,h,d,f,F,V,W){l.read=function(e,r,l,u,h){var d,f,F=8*h-u-1,V=(1<<F)-1,W=V>>1,q=-7,$=l?h-1:0,Q=l?-1:1;for(h=e[r+$],$+=Q,d=h&(1<<-q)-1,h>>=-q,q+=F;0<q;d=256*d+e[r+$],$+=Q,q-=8);for(f=d&(1<<-q)-1,d>>=-q,q+=u;0<q;f=256*f+e[r+$],$+=Q,q-=8);if(0===d)d=1-W;else{if(d===V)return f?NaN:1/0*(h?-1:1);f+=Math.pow(2,u),d-=W}return(h?-1:1)*f*Math.pow(2,d-u)},l.write=function(e,r,l,u,h,d){var f,F,V=8*d-h-1,W=(1<<V)-1,q=W>>1,$=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,Q=u?0:d-1,J=u?1:-1;for(d=r<0||0===r&&1/r<0?1:0,r=Math.abs(r),isNaN(r)||r===1/0?(F=isNaN(r)?1:0,f=W):(f=Math.floor(Math.log(r)/Math.LN2),r*(u=Math.pow(2,-f))<1&&(f--,u*=2),2<=(r+=1<=f+q?$/u:$*Math.pow(2,1-q))*u&&(f++,u/=2),W<=f+q?(F=0,f=W):1<=f+q?(F=(r*u-1)*Math.pow(2,h),f+=q):(F=r*Math.pow(2,q-1)*Math.pow(2,h),f=0));8<=h;e[l+Q]=255&F,Q+=J,F/=256,h-=8);for(f=f<<h|F,V+=h;0<V;e[l+Q]=255&f,Q+=J,f/=256,V-=8);e[l+Q-J]|=128*d}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,r,l){(function(e,l,u,h,d,f,F,V,W){function p(){}(e=r.exports={}).nextTick=function(e){setTimeout(e,0)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.on=p,e.addListener=p,e.once=p,e.off=p,e.removeListener=p,e.removeAllListeners=p,e.emit=p,e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),typeof self<"u"?self:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)),function(){if(Ai)return _i;Ai=1;var e=Wd();_i=function(r,l){var u=e(l),h=[];return h=h.concat(u(r)),h=h.concat(u(null))}}();var Pi,Ri,Ci,Li="csm_Position",Di="csm_PositionRaw",ki="csm_PointSize",Oi="csm_FragColor",Ni="csm_DiffuseColor",Ui="csm_Normal",ji="csm_Roughness",zi="csm_Metalness",Bi="csm_Emissive",Fi="csm_AO",Hi="csm_Bump",Gi="csm_DepthAlpha";Ge(Pi={},"".concat(Ui),{"#include <beginnormal_vertex>":"\n    vec3 objectNormal = ".concat(Ui,";\n    #ifdef USE_TANGENT\n\t    vec3 objectTangent = vec3( tangent.xyz );\n    #endif\n    ")}),Ge(Pi,"".concat(Li),{"#include <begin_vertex>":"\n    vec3 transformed = ".concat(Li,";\n  ")}),Ge(Pi,"".concat(Di),{"#include <begin_vertex>":"\n    vec4 csm_internal_positionUnprojected = ".concat(Di,";\n    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;\n    #ifdef USE_INSTANCING\n      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;\n    #endif\n    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;\n    vec3 transformed = csm_internal_positionUnprojected.xyz;\n  ")}),Ge(Pi,"".concat(ki),{"gl_PointSize = size;":"\n    gl_PointSize = ".concat(ki,";\n    ")}),Ge(Pi,"".concat(Ni),{"#include <color_fragment>":"\n    #include <color_fragment>\n    diffuseColor = ".concat(Ni,";\n  ")}),Ge(Pi,"".concat(Oi),{"#include <dithering_fragment>":"\n    #include <dithering_fragment>\n    gl_FragColor  = ".concat(Oi,";\n  ")}),Ge(Pi,"".concat(Bi),{"vec3 totalEmissiveRadiance = emissive;":"\n    vec3 totalEmissiveRadiance = ".concat(Bi,";\n    ")}),Ge(Pi,"".concat(ji),{"#include <roughnessmap_fragment>":"\n    #include <roughnessmap_fragment>\n    roughnessFactor = ".concat(ji,";\n    ")}),Ge(Pi,"".concat(zi),{"#include <metalnessmap_fragment>":"\n    #include <metalnessmap_fragment>\n    metalnessFactor = ".concat(zi,";\n    ")}),Ge(Pi,"".concat(Fi),{"#include <aomap_fragment>":"\n    #include <aomap_fragment>\n    reflectedLight.indirectDiffuse *= 1. - ".concat(Fi,";\n    ")}),Ge(Pi,"".concat(Hi),{"#include <normal_fragment_maps>":"\n    #include <normal_fragment_maps>\n\n    vec3 csm_internal_orthogonal = ".concat(Hi," - (dot(").concat(Hi,", normal) * normal);\n    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;\n    normal = normalize(normal - csm_internal_projectedbump);\n    ")}),Ge(Pi,"".concat(Gi),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":"\n      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * ".concat(Gi," );\n    "),"gl_FragColor = packDepthToRGBA( fragCoordZ );":"\n      gl_FragColor = packDepthToRGBA( fragCoordZ );\n      gl_FragColor.a *= ".concat(Gi,";\n    ")}),Ge(Ri={},"".concat(Li),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( ".concat(Li,", 1.0 );\n  ")}),Ge(Ri,"".concat(Di),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":"\n    gl_Position = ".concat(Li,";\n  ")}),Ge(Ri,"".concat(Ni),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(Ni,";\n  ")}),Ge(Ri,"".concat(Oi),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":"\n    gl_FragColor = ".concat(Oi,";\n  ")}),Ge(Ci={},"".concat(Li),"*"),Ge(Ci,"".concat(Di),"*"),Ge(Ci,"".concat(Ui),"*"),Ge(Ci,"".concat(ki),["PointsMaterial"]),Ge(Ci,"".concat(Ni),"*"),Ge(Ci,"".concat(Oi),"*"),Ge(Ci,"".concat(Bi),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ge(Ci,"".concat(ji),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ge(Ci,"".concat(zi),["MeshStandardMaterial","MeshPhysicalMaterial"]),Ge(Ci,"".concat(Fi),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),Ge(Ci,"".concat(Hi),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),Ge(Ci,"".concat(Gi),"*"),$({name:"BakeShadows",setup(){const{renderer:e}=me();ve(()=>{e.value.shadowMap.autoUpdate=!1,e.value.shadowMap.needsUpdate=!0})}});new Ve(0,0,0),new Ve(0,0,0),new Ve(0,0,0);new bn,Boolean,Boolean,Boolean,Boolean,Boolean;var Vi,Yi={exports:{}};var Xi=(Vi||(Vi=1,Yi.exports=function(){var t=function(){function n(e){return r.appendChild(e.dom),e}function s(l){for(var u=0;u<r.children.length;u++)r.children[u].style.display=u===l?"block":"none";e=l}var e=0,r=(void 0).createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(l){l.preventDefault(),s(++e%r.children.length)},!1);var l=(performance||Date).now(),u=l,h=0,d=n(new t.Panel("FPS","#0ff","#002")),f=n(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var F=n(new t.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:r,addPanel:n,showPanel:s,begin:function(){l=(performance||Date).now()},end:function(){h++;var e=(performance||Date).now();if(f.update(e-l,200),e>u+1e3&&(d.update(1e3*h/(e-u),100),u=e,h=0,F)){var r=performance.memory;F.update(r.usedJSHeapSize/1048576,r.jsHeapSizeLimit/1048576)}return e},update:function(){l=this.end()},domElement:r,setMode:s}};return t.Panel=function(e,r,l){var u=1/0,h=0,d=Math.round,f=d((void 0).devicePixelRatio||1),F=80*f,V=48*f,W=3*f,q=2*f,$=3*f,Q=15*f,J=74*f,re=30*f,oe=(void 0).createElement("canvas");oe.width=F,oe.height=V,oe.style.cssText="width:80px;height:48px";var ae=oe.getContext("2d");return ae.font="bold "+9*f+"px Helvetica,Arial,sans-serif",ae.textBaseline="top",ae.fillStyle=l,ae.fillRect(0,0,F,V),ae.fillStyle=r,ae.fillText(e,W,q),ae.fillRect($,Q,J,re),ae.fillStyle=l,ae.globalAlpha=.9,ae.fillRect($,Q,J,re),{dom:oe,update:function(V,le){u=Math.min(u,V),h=Math.max(h,V),ae.fillStyle=l,ae.globalAlpha=1,ae.fillRect(0,0,F,Q),ae.fillStyle=r,ae.fillText(d(V)+" "+e+" ("+d(u)+"-"+d(h)+")",W,q),ae.drawImage(oe,$+f,Q,J-f,re,$,Q,J-f,re),ae.fillRect($+J-f,Q,f,re),ae.fillStyle=l,ae.globalAlpha=.9,ae.fillRect($+J-f,Q,f,d((1-V/le)*re))}}},t}()),Yi.exports);const Ki=Ps(Xi);$({name:"Stats",props:{showPanel:{type:Number,default:0}},setup(e,{expose:r}){const l=new Ki;r({instance:l});const u=(void 0).body;l.showPanel(e.showPanel||0),null==u||u.appendChild(l.dom);const{onBeforeRender:h,onAfterRender:d}=Zr$1();h(()=>l.begin(),Number.NEGATIVE_INFINITY),d(()=>l.end(),Number.POSITIVE_INFINITY),le(()=>{null==u||u.removeChild(l.dom)})}});const Wi=class Zn{constructor({trackGPU:e=!1,logsPerSecond:r=30,samplesLog:l=60,samplesGraph:u=10,precision:h=2,minimal:d=!1,horizontal:f=!0,mode:F=0}={}){this.gl=null,this.ext=null,this.activeQuery=null,this.gpuQueries=[],this.threeRendererPatched=!1,this.frames=0,this.renderCount=0,this.isRunningCPUProfiling=!1,this.totalCpuDuration=0,this.totalGpuDuration=0,this.totalGpuDurationCompute=0,this.totalFps=0,this.gpuPanel=null,this.gpuPanelCompute=null,this.averageFps={logs:[],graph:[]},this.averageCpu={logs:[],graph:[]},this.averageGpu={logs:[],graph:[]},this.averageGpuCompute={logs:[],graph:[]},this.handleClick=e=>{e.preventDefault(),this.showPanel(++this.mode%this.dom.children.length)},this.handleResize=()=>{this.resizePanel(this.fpsPanel,0),this.resizePanel(this.msPanel,1),this.gpuPanel&&this.resizePanel(this.gpuPanel,2),this.gpuPanelCompute&&this.resizePanel(this.gpuPanelCompute,3)},this.mode=F,this.horizontal=f,this.minimal=d,this.trackGPU=e,this.samplesLog=l,this.samplesGraph=u,this.precision=h,this.logsPerSecond=r,this.dom=(void 0).createElement("div"),this.initializeDOM(),this.beginTime=performance.now(),this.prevTime=this.beginTime,this.prevCpuTime=this.beginTime,this.fpsPanel=this.addPanel(new Zn.Panel("FPS","#0ff","#002"),0),this.msPanel=this.addPanel(new Zn.Panel("CPU","#0f0","#020"),1),this.setupEventListeners()}initializeDOM(){this.dom.style.cssText=`\n      position: fixed;\n      top: 0;\n      left: 0;\n      opacity: 0.9;\n      z-index: 10000;\n      ${this.minimal?"cursor: pointer;":""}\n    `}setupEventListeners(){this.minimal?(this.dom.addEventListener("click",this.handleClick),this.showPanel(this.mode)):(void 0).addEventListener("resize",this.handleResize)}async init(e){e&&(this.handleThreeRenderer(e)||await this.handleWebGPURenderer(e)||this.initializeWebGL(e))}handleThreeRenderer(e){return!(!e.isWebGLRenderer||this.threeRendererPatched)&&(this.patchThreeRenderer(e),this.gl=e.getContext(),this.trackGPU&&this.initializeGPUTracking(),!0)}async handleWebGPURenderer(e){return!!e.isWebGPURenderer&&(this.trackGPU&&(e.backend.trackTimestamp=!0,await e.hasFeatureAsync("timestamp-query")&&this.initializeWebGPUPanels()),this.info=e.info,!0)}initializeWebGPUPanels(){this.gpuPanel=this.addPanel(new Zn.Panel("GPU","#ff0","#220"),2),this.gpuPanelCompute=this.addPanel(new Zn.Panel("CPT","#e1e1e1","#212121"),3)}initializeWebGL(e){if(e instanceof WebGL2RenderingContext)this.gl=e;else{if(!(e instanceof HTMLCanvasElement||e instanceof OffscreenCanvas))return!1;if(this.gl=e.getContext("webgl2"),!this.gl)return!1}return!0}initializeGPUTracking(){this.gl&&(this.ext=this.gl.getExtension("EXT_disjoint_timer_query_webgl2"),this.ext&&(this.gpuPanel=this.addPanel(new Zn.Panel("GPU","#ff0","#220"),2)))}begin(){this.isRunningCPUProfiling||this.beginProfiling("cpu-started"),this.gl&&this.ext&&(this.activeQuery&&this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.activeQuery=this.gl.createQuery(),this.activeQuery&&this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,this.activeQuery))}end(){this.renderCount++,this.gl&&this.ext&&this.activeQuery&&(this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.gpuQueries.push({query:this.activeQuery}),this.activeQuery=null)}update(){this.info?this.processWebGPUTimestamps():this.processGpuQueries(),this.endProfiling("cpu-started","cpu-finished","cpu-duration"),this.updateAverages(),this.resetCounters()}processWebGPUTimestamps(){this.totalGpuDuration=this.info.render.timestamp,this.totalGpuDurationCompute=this.info.compute.timestamp,this.addToAverage(this.totalGpuDurationCompute,this.averageGpuCompute)}updateAverages(){this.addToAverage(this.totalCpuDuration,this.averageCpu),this.addToAverage(this.totalGpuDuration,this.averageGpu)}resetCounters(){this.renderCount=0,0===this.totalCpuDuration&&this.beginProfiling("cpu-started"),this.totalCpuDuration=0,this.totalFps=0,this.beginTime=this.endInternal()}resizePanel(e,r){e.canvas.style.position="absolute",this.minimal?e.canvas.style.display="none":(e.canvas.style.display="block",this.horizontal?(e.canvas.style.top="0px",e.canvas.style.left=r*e.WIDTH/e.PR+"px"):(e.canvas.style.left="0px",e.canvas.style.top=r*e.HEIGHT/e.PR+"px"))}addPanel(e,r){return e.canvas&&(this.dom.appendChild(e.canvas),this.resizePanel(e,r)),e}showPanel(e){for(let r=0;r<this.dom.children.length;r++){this.dom.children[r].style.display=r===e?"block":"none"}this.mode=e}processGpuQueries(){!this.gl||!this.ext||(this.totalGpuDuration=0,this.gpuQueries.forEach((e,r)=>{if(this.gl){const l=this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT_AVAILABLE),u=this.gl.getParameter(this.ext.GPU_DISJOINT_EXT);if(l&&!u){const l=1e-6*this.gl.getQueryParameter(e.query,this.gl.QUERY_RESULT);this.totalGpuDuration+=l,this.gl.deleteQuery(e.query),this.gpuQueries.splice(r,1)}}}))}endInternal(){this.frames++;const e=(performance||Date).now(),r=e-this.prevTime;if(e>=this.prevCpuTime+1e3/this.logsPerSecond){const l=Math.round(1e3*this.frames/r);this.addToAverage(l,this.averageFps),this.updatePanel(this.fpsPanel,this.averageFps,0),this.updatePanel(this.msPanel,this.averageCpu,this.precision),this.updatePanel(this.gpuPanel,this.averageGpu,this.precision),this.gpuPanelCompute&&this.updatePanel(this.gpuPanelCompute,this.averageGpuCompute),this.frames=0,this.prevCpuTime=e,this.prevTime=e}return e}addToAverage(e,r){r.logs.push(e),r.logs.length>this.samplesLog&&r.logs.shift(),r.graph.push(e),r.graph.length>this.samplesGraph&&r.graph.shift()}beginProfiling(e){(void 0).performance&&((void 0).performance.mark(e),this.isRunningCPUProfiling=!0)}endProfiling(e,r,l){if((void 0).performance&&r&&this.isRunningCPUProfiling){(void 0).performance.mark(r);const u=performance.measure(l,e,r);this.totalCpuDuration+=u.duration,this.isRunningCPUProfiling=!1}}updatePanel(e,r,l=2){if(r.logs.length>0){let u=0,h=.01;for(let e=0;e<r.logs.length;e++)u+=r.logs[e],r.logs[e]>h&&(h=r.logs[e]);let d=0,f=.01;for(let e=0;e<r.graph.length;e++)d+=r.graph[e],r.graph[e]>f&&(f=r.graph[e]);e&&e.update(u/Math.min(r.logs.length,this.samplesLog),d/Math.min(r.graph.length,this.samplesGraph),h,f,l)}}get domElement(){return this.dom}patchThreeRenderer(e){const r=e.render,l=this;e.render=function(e,u){l.begin(),r.call(this,e,u),l.end()},this.threeRendererPatched=!0}};Wi.Panel=class{constructor(e,r,l){this.name=e,this.fg=r,this.bg=l,this.gradient=null,this.PR=Math.round((void 0).devicePixelRatio||1),this.WIDTH=90*this.PR,this.HEIGHT=48*this.PR,this.TEXT_X=3*this.PR,this.TEXT_Y=2*this.PR,this.GRAPH_X=3*this.PR,this.GRAPH_Y=15*this.PR,this.GRAPH_WIDTH=84*this.PR,this.GRAPH_HEIGHT=30*this.PR,this.canvas=(void 0).createElement("canvas"),this.canvas.width=this.WIDTH,this.canvas.height=this.HEIGHT,this.canvas.style.width="90px",this.canvas.style.height="48px",this.canvas.style.position="absolute",this.canvas.style.cssText="width:90px;height:48px",this.context=this.canvas.getContext("2d"),this.initializeCanvas()}createGradient(){if(!this.context)throw new Error("No context");const e=this.context.createLinearGradient(0,this.GRAPH_Y,0,this.GRAPH_Y+this.GRAPH_HEIGHT);let r;const l=this.fg;switch(this.fg.toLowerCase()){case"#0ff":r="#006666";break;case"#0f0":r="#006600";break;case"#ff0":r="#666600";break;case"#e1e1e1":r="#666666";break;default:r=this.bg}return e.addColorStop(0,r),e.addColorStop(1,l),e}initializeCanvas(){this.context&&(this.context.font="bold "+9*this.PR+"px Helvetica,Arial,sans-serif",this.context.textBaseline="top",this.gradient=this.createGradient(),this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.HEIGHT),this.context.fillStyle=this.fg,this.context.fillText(this.name,this.TEXT_X,this.TEXT_Y),this.context.fillStyle=this.fg,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT),this.context.fillStyle=this.bg,this.context.globalAlpha=.9,this.context.fillRect(this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH,this.GRAPH_HEIGHT))}update(e,r,l,u,h=0){if(!this.context||!this.gradient)return;const d=Math.min(1/0,e),f=Math.max(l,e);u=Math.max(u,r),this.context.globalAlpha=1,this.context.fillStyle=this.bg,this.context.fillRect(0,0,this.WIDTH,this.GRAPH_Y),this.context.fillStyle=this.fg,this.context.fillText(`${e.toFixed(h)} ${this.name} (${d.toFixed(h)}-${parseFloat(f.toFixed(h))})`,this.TEXT_X,this.TEXT_Y),this.context.drawImage(this.canvas,this.GRAPH_X+this.PR,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT,this.GRAPH_X,this.GRAPH_Y,this.GRAPH_WIDTH-this.PR,this.GRAPH_HEIGHT);const F=this.GRAPH_HEIGHT-(1-r/u)*this.GRAPH_HEIGHT;F>0&&(this.context.globalAlpha=1,this.context.fillStyle=this.gradient,this.context.fillRect(this.GRAPH_X+this.GRAPH_WIDTH-this.PR,this.GRAPH_Y+this.GRAPH_HEIGHT-F,this.PR,F))}};let qi=Wi;$({name:"StatsGl",props:["logsPerSecond","samplesLog","samplesGraph","precision","horizontal","minimal","mode"],setup(e,{expose:r}){const l=new qi({logsPerSecond:e.logsPerSecond,samplesLog:e.samplesLog,samplesGraph:e.samplesGraph,precision:e.precision,horizontal:e.horizontal,minimal:e.minimal,mode:e.mode});r({instance:l});const u=(void 0).body,h=l.dom||l.container;null==u||u.appendChild(h);const{renderer:d}=me(),{onAfterRender:f}=Zr$1();l.init(d.value),f(()=>l.update(),Number.POSITIVE_INFINITY),le(()=>{null==u||u.removeChild(h)})}});Boolean,new ot(16777215);const Zi=$({name:"ModelThreeD",__name:"ModelThreeD",__ssrInlineRender:!0,props:{modelPath:{},draco:{type:Boolean,default:!0}},async setup(e,{expose:r}){let u,h;const d=e,{modelPath:f,draco:F}=d;r({startRotation:()=>{q.value=!0},stopRotation:()=>{q.value=!1}});const{scene:V}=([u,h]=Se(()=>kd(f,{draco:F})),u=await u,h(),u),q=W(!0);return(nr||(nr=!0,Qn()),{onBeforeLoop:Vn.on,onLoop:Yn.on,onAfterLoop:Xn.on,pause:$n,resume:Qn,isActive:Jn}).onLoop(()=>{V&&q.value&&(V.rotation.y+=.01)}),(e,r,u,h)=>{r(`<primitive${l(Ce({object:ce(V)},h))}></primitive>`)}}}),$i=$({__name:"ThreeDCar",__ssrInlineRender:!0,setup(e){const F=W(),V=W(!1),onModelReady=()=>{V.value=!0},q=W(!1),$=W(0);return(async()=>{const{hasFinishLoading:e,progress:r}=await function(){const e=W(!1),r=W(0),l=W([]);return new Promise(u=>{Be.onStart=()=>{e.value=!1},Be.onLoad=()=>{e.value=!0},Be.onProgress=(u,h,d)=>{h===d&&(li=d,e.value=!0,l.value.push(u)),r.value=Math.round((h-li)/(d-li)*100||100)},Be.onError=r=>{e.value=!0},u({items:l,hasFinishLoading:e,progress:r})})}();ve(()=>{$.value=r.value,q.value=e.value})})(),(e,V,W,Q)=>{const J=r,re=Hn,oe=Zi;V(`<div${l(Ce({class:"car-viewer"},Q))} data-v-a0704877>`),ce(q)?V("\x3c!----\x3e"):V(`<div class="loading-overlay" data-v-a0704877> Loading... ${u(Math.round(ce($)))}% </div>`),V('<div class="controls" data-v-a0704877><div data-v-a0704877><button data-v-a0704877>Start Rotation</button><button data-v-a0704877>Stop Rotation</button></div><h1 class="controls__title" data-v-a0704877>'),V(h(J,{to:"https://docs.tresjs.org/",external:"",target:"_blank"},{default:Le((e,r,l,u)=>{if(!r)return[De(" TresJS create awesome 3D ")];r(" TresJS create awesome 3D ")}),_:1},W)),V("</h1></div>"),V(h(re,{"clear-color":"#161313",shadows:"",alpha:""},{default:Le((e,r,l,u)=>{if(!r)return[Ae("TresPerspectiveCamera",{ref:"camera",position:[8,4,8],fov:45,"look-at":[0,0,0]},null,512),Ae("TresAmbientLight",{intensity:.4}),Ae("TresDirectionalLight",{position:[10,10,5],intensity:1,"cast-shadow":""}),Ae("TresDirectionalLight",{position:[-10,5,-5],intensity:.5}),Ae(ce(ii),{"enable-damping":!0,"damping-factor":.05,"max-distance":20,"min-distance":3,"max-polar-angle":Math.PI/2},null,8,["max-polar-angle"]),(ue(),Ee(ke,{onResolve:onModelReady},{default:Le(()=>[Ae(oe,{ref_key:"modelRef",ref:F,"model-path":"/models/retro-futuristic-car.glb"},null,512)]),_:1})),Ae("TresDirectionalLight",{position:[-4,8,4],intensity:1.5,"cast-shadow":""}),Ae("TresMesh",{position:[0,-.5,0],rotation:[-Math.PI/2,0,0]},[Ae("TresPlaneGeometry",{args:[10,10]}),Ae("TresMeshLambertMaterial",{color:"#2684ff"})],8,["rotation"])];r(`<TresPerspectiveCamera${d("position",[8,4,8])}${d("fov",45)}${d("look-at",[0,0,0])} data-v-a0704877${u}></TresPerspectiveCamera><TresAmbientLight${d("intensity",.4)} data-v-a0704877${u}></TresAmbientLight><TresDirectionalLight${d("position",[10,10,5])}${d("intensity",1)} cast-shadow data-v-a0704877${u}></TresDirectionalLight><TresDirectionalLight${d("position",[-10,5,-5])}${d("intensity",.5)} data-v-a0704877${u}></TresDirectionalLight>`),r(h(ce(ii),{"enable-damping":!0,"damping-factor":.05,"max-distance":20,"min-distance":3,"max-polar-angle":Math.PI/2},null,l,u)),f(r,{default:()=>{r(h(oe,{ref_key:"modelRef",ref:F,"model-path":"/models/retro-futuristic-car.glb"},null,l,u))},_:1}),r(`<TresDirectionalLight${d("position",[-4,8,4])}${d("intensity",1.5)} cast-shadow data-v-a0704877${u}></TresDirectionalLight><TresMesh${d("position",[0,-.5,0])}${d("rotation",[-Math.PI/2,0,0])} data-v-a0704877${u}><TresPlaneGeometry${d("args",[10,10])} data-v-a0704877${u}></TresPlaneGeometry><TresMeshLambertMaterial color="#2684ff" data-v-a0704877${u}></TresMeshLambertMaterial></TresMesh>`)}),_:1},W)),V("</div>")}}}),Qi=$i.setup;$i.setup=(e,r)=>{const l=F();return(l.modules||(l.modules=new Set)).add("components/features/ThreeDCar.vue"),Qi?Qi(e,r):void 0};const Ji=e($i,[["__scopeId","data-v-a0704877"]]);export{Ji as default};
//# sourceMappingURL=ThreeDCar.vue.mjs.map
